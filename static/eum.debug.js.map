{"version":3,"file":"eum.debug.js","sources":["../lib/phases.js","../lib/browser.js","../lib/util.js","../lib/debug.js","../lib/timers.js","../lib/eventBus.js","../lib/events/onLoad.js","../lib/fsm.js","../lib/performance.js","../lib/vars.js","../lib/states/waitForPageLoad.js","../lib/commonBeaconProperties.js","../lib/resources/consts.js","../lib/resources/timingSerializer.js","../lib/ignoreRules.js","../lib/trie.js","../lib/resources/resources.js","../lib/timings.js","../lib/events/onLastChance.js","../lib/hooks/xhrHelpers.js","../lib/transmission/lineEncoding.js","../lib/transmission/batched.js","../lib/excessiveUsageIdentification.js","../lib/transmission/formEncoded.js","../lib/transmission/index.js","../lib/states/pageLoaded.js","../lib/hooks/unhandledError.js","../lib/hooks/unhandledRejection.js","../lib/performanceObserver.js","../lib/allowedOrigins.js","../lib/hooks/normalizeUrl.js","../lib/sop.js","../lib/hooks/XMLHttpRequest.js","../lib/serverTiming.js","../lib/asyncFunctionWrapping.js","../lib/hooks/eventHandlers.js","../lib/customEvents.js","../lib/hooks/userTiming.js","../lib/hooks/Fetch.js","../lib/localStorage.js","../lib/session.js","../lib/pageChange.js","../lib/commands.js","../lib/hooks/timers.js","../node_modules/web-vitals/dist/web-vitals.es5.min.js","../lib/webVitals.js","../lib/states/init.js","../lib/index.js"],"sourcesContent":["// @flow\n\nexport const pageLoad = 'pl';\n","// @flow\n\n// aliasing globals for improved minifications\n\n\nexport const win: any = window;\nexport const doc: any = win.document;\nexport const nav: any = navigator;\nexport const encodeURIComponent: string => string = win.encodeURIComponent;\nexport const XMLHttpRequest = win.XMLHttpRequest;\nexport const originalFetch = win.fetch;\nexport const localStorage: ?Storage = (function() {\n  try {\n    return win.localStorage;\n  } catch (e) {\n    // localStorage access is not permitted in certain security modes, e.g.\n    // when cookies are completely disabled in web browsers.\n    return null;\n  }\n})();\n\n/**\n * Leverage's browser behavior to load image sources. Exposed via this module\n * to enable testing.\n */\nexport function executeImageRequest(url: string) {\n  const image = new Image();\n  image.src = url;\n}\n\n/**\n * Exposed via this module to enable testing.\n */\nexport function sendBeacon(url: string, data: string): boolean {\n  return nav.sendBeacon(url, data);\n}\n","// @flow\n\nimport {win} from './browser';\n\n// aliasing the global function for improved minification and\n// protection against hasOwnProperty overrides.\nconst globalHasOwnProperty = Object.prototype.hasOwnProperty;\nexport function hasOwnProperty(obj: Object, key: string) {\n  return globalHasOwnProperty.call(obj, key);\n}\n\nexport function now(): number {\n  return new Date().getTime();\n}\n\nexport function noop() {}\n\n// We are trying to stay close to common tracing architectures and use\n// a hex encoded 64 bit random ID.\nvar validIdCharacters = '0123456789abcdef'.split('');\nlet generateUniqueIdImpl: () => string = function generateUniqueIdViaRandom(): string {\n  let result = '';\n  for (let i = 0; i < 16; i++) {\n    result += validIdCharacters[Math.round(Math.random() * 15)];\n  }\n  return result;\n};\n\nif (win.crypto && win.crypto.getRandomValues && win.Uint32Array) {\n  generateUniqueIdImpl = function generateUniqueIdViaCrypto(): string {\n    const array = new win.Uint32Array(2);\n    win.crypto.getRandomValues(array);\n    return array[0].toString(16) + array[1].toString(16);\n  };\n}\n\nexport const generateUniqueId = generateUniqueIdImpl;\n\nexport function addEventListener(target: EventTarget, eventType: string, callback: Event => mixed) {\n  if (target.addEventListener) {\n    target.addEventListener(eventType, callback, false);\n  } else if (target.attachEvent) {\n    target.attachEvent('on' + eventType, callback);\n  }\n}\n\n\nexport function removeEventListener(target: EventTarget, eventType: string, callback: () => mixed) {\n  if (target.removeEventListener) {\n    target.removeEventListener(eventType, callback, false);\n  } else if (target.detachEvent) {\n    target.detachEvent('on' + eventType, callback);\n  }\n}\n\n\nexport function matchesAny(regexp: RegExp[], s: string) {\n  for (let i = 0, len = regexp.length; i < len; i++) {\n    if (regexp[i].test(s)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","/* eslint-disable no-console */\n\n// @flow\n\nimport {noop} from './util';\n\ntype Logger = (...any) => void;\n\n// $FlowFixMe The function is never going to be used when it is a bool\nexport const log: Logger = DEBUG && createLogger('log');\n// $FlowFixMe The function is never going to be used when it is a bool\nexport const info: Logger = DEBUG && createLogger('info');\n// $FlowFixMe The function is never going to be used when it is a bool\nexport const warn: Logger = DEBUG && createLogger('warn');\n// $FlowFixMe The function is never going to be used when it is a bool\nexport const error: Logger = DEBUG && createLogger('error');\n// $FlowFixMe The function is never going to be used when it is a bool\nexport const debug: Logger = DEBUG && createLogger('debug');\n\nfunction createLogger(method): (...any) => void {\n  if (typeof console === 'undefined' || typeof console.log !== 'function' || typeof console.log.apply !== 'function') {\n    return noop;\n  }\n\n  if (console[method] && typeof console[method].apply === 'function') {\n    return function() {\n      console[method].apply(console, arguments);\n    };\n  }\n\n  return function() {\n    console.log.apply(console, arguments);\n  };\n}\n","import {warn, info} from './debug';\nimport {win} from './browser';\n\n// This module contains wrappers around the standard timer API. These wrappers can be used to\n// ensure that execution of timers happens outside of any Angular specific zones. This in turn\n// means that this script will never disturb Angular's stabilization phase.\n// https://angular.io/api/core/ApplicationRef#isStable\n// Please note that it may sometimes be necessary to deliberately execute code inside of\n// Angular's Zones. Always take care to make a deliberate decision when to use and when not to\n// use these wrappers.\n\n// We take a copy of all globals to ensure that no other script will change them all of a sudden.\n// This ensures that when we register a timeout/interval on one global, that we will be able to\n// de-register it again in all cases.\nconst globals = {\n  'setTimeout': win.setTimeout,\n  'clearTimeout': win.clearTimeout,\n  'setInterval': win.setInterval,\n  'clearInterval': win.clearInterval\n};\n\n// If the globals don't exist at execution time of this file, then we know that the globals stored\n// above are not wrapped by Zone.js. This in turn can mean better performance for Angular users.\nexport const isRunningZoneJs = win['Zone'] != null &&\n  win['Zone']['root'] != null &&\n  typeof win['Zone']['root']['run'] === 'function';\n\nif (DEBUG && isRunningZoneJs) {\n  info('Discovered Zone.js globals. Will attempt to register all timers inside the root Zone.');\n}\n\nexport function setTimeout() {\n  return executeGlobally.apply('setTimeout', arguments);\n}\n\nexport function clearTimeout() {\n  return executeGlobally.apply('clearTimeout', arguments);\n}\n\nexport function setInterval() {\n  return executeGlobally.apply('setInterval', arguments);\n}\n\nexport function clearInterval() {\n  return executeGlobally.apply('clearInterval', arguments);\n}\n\nfunction executeGlobally() {\n  // We don't want to incur a performance penalty for all users just because some\n  // users are relying on zone.js. This API looks quite ridiculous, but it\n  // allows for concise and efficient code, e.g. arguments does not need to be\n  // translated into an array.\n  const globalFunctionName = this;\n\n  if (isRunningZoneJs) {\n    try {\n      // Incurr a performance overhead for Zone.js users that we just cannot avoid:\n      // Copy the arguments passed in here so that we can use them inside the root\n      // zone.\n      const args = Array.prototype.slice.apply(arguments);\n      return win['Zone']['root']['run'](globals[globalFunctionName], win, args);\n    } catch (e) {\n      if (DEBUG) {\n        warn('Failed to execute %s inside of zone (via Zone.js). Falling back to execution inside currently ' +\n          'active zone.', globalFunctionName, e);\n      }\n      // failure â€“ maybe zone js not properly initialized? Fall back to execution\n      // outside of Zone.js as a last resort (outside of try/catch and if)\n    }\n  }\n\n  // Note: Explicitly passing win as 'this' even though we are getting the function from 'globals'\n  return globals[globalFunctionName].apply(win, arguments);\n}\n\n","// @flow\n\nlet bus = {};\n\ntype Listener = mixed => mixed;\n\nexport function on(name: string, fn: Listener) {\n  var listeners = bus[name] = bus[name] || [];\n  listeners.push(fn);\n}\n\nexport function off(name: string, fn: Listener) {\n  var listeners = bus[name];\n  if (!listeners) {\n    return;\n  }\n\n  for (var i = listeners.length - 1; i >= 0; i--) {\n    if (listeners[i] === fn) {\n      listeners.splice(i, 1);\n    }\n  }\n\n  if (listeners.length === 0) {\n    delete bus[name];\n  }\n}\n\nexport function emit(name: string, value: mixed) {\n  var listeners = bus[name];\n  if (!listeners) {\n    return;\n  }\n  for (var i = 0, length = listeners.length; i < length; i++) {\n    listeners[i](value);\n  }\n}\n\nexport function reset() {\n  bus = {};\n}\n","// @flow\n\nimport {addEventListener, now} from '../util';\nimport {setTimeout} from '../timers';\nimport type {Event} from '../types';\nimport {emit} from '../eventBus';\nimport {win} from '../browser';\n\nconst event: Event = {\n  name: 'e:onLoad',\n  time: null,\n  initialize() {\n    if (document.readyState === 'complete') {\n      return onReady();\n    }\n    addEventListener(win, 'load', function() {\n      // we want to get timing data for loadEventEnd,\n      // so asynchronously process this\n      setTimeout(onReady, 0);\n    });\n  }\n};\n\nfunction onReady() {\n  event.time = now();\n  emit(event.name, event.time);\n}\n\nexport default event;\n","// @flow\n\nimport type {State} from './types';\nimport {info} from './debug';\n\nconst states: {[name: string]: State} = {};\nlet currentStateName;\n\nexport function registerState(name: string, impl: State) {\n  states[name] = impl;\n}\n\nexport function transitionTo(nextStateName: string) {\n  if (DEBUG) {\n    info('Transitioning from %s to %s', currentStateName || '<no state>', nextStateName);\n  }\n\n  currentStateName = nextStateName;\n  states[nextStateName].onEnter();\n}\n\nexport function getActiveTraceId(): ?string {\n  return states[currentStateName].getActiveTraceId();\n}\n\nexport function getActivePhase(): ?string {\n  return states[currentStateName].getActivePhase();\n}\n","// @flow\n\nimport {win} from './browser';\n\n// a wrapper around win.performance for cross-browser support\nexport const performance = win.performance ||\n  win.webkitPerformance ||\n  win.msPerformance ||\n  win.mozPerformance;\n\nexport const isTimingAvailable = performance && performance.timing;\nexport const isResourceTimingAvailable = performance && performance.getEntriesByType;\nexport const isPerformanceObserverAvailable = performance &&\n  typeof win['PerformanceObserver'] === 'function' &&\n  typeof performance['now'] === 'function';\n","// @flow\n\nimport {generateUniqueId, now} from './util';\nimport {performance} from './performance';\nimport type {Meta} from './types';\n\nconst defaultVars: {\n  // This is the global object name which the user of the EUM\n  // product has no influence over. This should be chosen\n  // wisely such that conflicts with other tools are highly\n  // unlikely.\n  nameOfLongGlobal: string,\n\n  // The version of the snippet loading/initializing Weasel.\n  // This value is automatically retrieved from the global\n  // object's `v` field.\n  trackingSnippetVersion: ?string,\n\n  // The trace id of the page load. You should never need to\n  // change this.\n  pageLoadTraceId: string,\n\n  // An optional trace ID to correlate the page load trace\n  // to a backend trace.\n  // Set via:\n  // eum('traceId', '123');\n  pageLoadBackendTraceId: ?string,\n\n  // Name of the server timing entry under which the backend trace\n  // ID can be found. Expects a server timing entry in the following\n  // format.\n  // PerformanceServerTiming {name: \"intid\", duration: 0, description: \"1f27caa3493aeb\"}\n  serverTimingBackendTraceIdEntryName: string,\n\n  // All timestamps which are part of beacons will be adjusted\n  // using this timestamp before transmission to save some bytes.\n  // So what we are doing is:\n  // timestampToTransmit = actualTimestamp - referenceTimestamp\n  referenceTimestamp: number,\n\n  // High resolution reference point. Will be used to relate\n  // high res timestamps to a value that client and server\n  // understands.\n  highResTimestampReference: number,\n\n  // The time at which the EUM initializer was executed. Useful\n  // to get a load time indicator for older devices.\n  initializerExecutionTimestamp: number,\n\n  // Changes the URL to which beacons will be send.\n  // Change via\n  // eum('reportingUrl', '//eum.example.com');\n  reportingUrl: ?string,\n\n  // The number of milliseconds to potentially wait to batch beacons\n  // into a single request.\n  // Change via\n  // eum('beaconBatchingTime', 1000);\n  beaconBatchingTime: number,\n\n  // How long to wait after an XMLHttpRequest or fetch request has finished\n  // for the retrieval of resource timing data. Performance timeline events\n  // are placed on the low priority task queue and therefore high values\n  // might be necessary.\n  //\n  // Change via:\n  // eum('maxWaitForResourceTimingsMillis', 5000);\n  maxWaitForResourceTimingsMillis: number,\n\n  // Weasel will wait up to this many milliseconds after the onLoad event\n  // completes for any additional metrics related to the page load, e.g.\n  // first input delay or cumulative layout shift. Additional waiting time\n  // means that:\n  //\n  //  1. Data is seen later within the monitoring system and\n  //  2. that data could theoretically be lost.\n  //\n  // Change via:\n  // eum('maxMaitForPageLoadMetricsMillis', 2000);\n  maxMaitForPageLoadMetricsMillis: number,\n\n  // Defines an application identification mechanism. This value\n  // will always be transfered with every beacon to associate\n  // requests with a monitored system.\n  // Change via:\n  // eum('apiKey', 'myKey');\n  apiKey: ?string,\n\n  // Defines user-configurable application payloads. These payloads\n  // will be transfered with the page load beacon and should be a\n  // Set meta data via:\n  // eum('meta', 'key', 'value');\n  meta: Meta,\n\n  // An array of URL regular expression for which no data should be\n  // collected. These regular expressions are evaluated against\n  // the document, XMLHttpRequest, fetch and resource URLs.\n  // Set via:\n  // eum('ignoreUrls', [/example.com/]);\n  ignoreUrls: RegExp[],\n\n  // Whether or not ping like requests should be ignored from AJAX\n  // collection. This is separate from ignoreUrls to handle cases\n  // where users start monitoring using weasel and generate tons\n  // of beacons which look like\n  // GET /ping\n  // These types of beacons are often times not really helpful and\n  // users typically only learn about these types of beacons after\n  // they have monitored using weasel for some time. At that point,\n  // this could have generated hundreds of thousands of beacons\n  // that nobody is interested in.\n  //\n  // Set via:\n  // eum('ignorePings', false);\n  ignorePings: boolean,\n\n  // An array of error message regular expressions for which no data\n  // should be collected.\n  // Set via:\n  // eum('ignoreErrorMessages', [/script error/i]);\n  ignoreErrorMessages: RegExp[],\n\n  // Timeout for the transmission of XHR beacons.\n  //\n  // Set via:\n  // eum('xhrTransmissionTimeout', 60000);\n  xhrTransmissionTimeout: number,\n\n  // Correlation headers can by default only be transmitted to the\n  // origin of the document. This is the case because the same-origin\n  // policy forbids a piece of JavaScript to send custom headers to\n  // request to other origins. This results in a lack of\n  // backend correlation which is especially bothersome when the\n  // document is an SPA which is always gathering data from a different\n  // origin.\n  //\n  // Custom headers can be enabled by leveraging CORS. With CORS,\n  // the server can denote that the tracing headers are to be\n  // allowed for cross-origin requests. The CORS specification\n  // has more information about the header:\n  //\n  // https://www.w3.org/TR/cors/#access-control-allow-headers-response-header\n  //\n  // Example header for the Instana tracing headers:\n  // Access-Control-Allow-Headers: X-INSTANA-T, X-INSTANA-S, X-INSTANA-L\n  //\n  // Next, the origin needs to be allowed via:\n  // eum('allowedOrigins', [/.*shop.example.com/i]);\n  //\n  // The regular expressions will be matched against URLs.\n  allowedOrigins: RegExp[],\n\n  // Name of the page which the user is currently viewing. May be set as\n  // part of the page load or later for SPA, XHR and error beacons.\n  // Any string can be used as the page name. Try to keep it short though\n  // for efficiency sake.\n  //\n  // Set via:\n  // eum('page', 'myPageName');\n  page: ?string,\n\n  // Whether or not weasel should automatically wrap DOM event handlers\n  // added via addEventlistener for improved uncaught error tracking.\n  // This results in improved uncaught error tracking for cross-origin\n  // errors, but may have adverse effects on website performance and\n  // stability.\n  //\n  // Set via:\n  // eum('wrapEventHandlers', true)\n  wrapEventHandlers: boolean,\n\n  // When wrapping event handlers (enabled only when wrapEventHandlers=true),\n  // we will have to wrap user provided callbacks in addEventListener. This\n  // wrapping is pretty straightforward in itself, but it becomes troublesome\n  // due to removeEventListener. Within removeEventListener, we somehow must\n  // map the original function to the mapped function. Otherwise, we would\n  // break the applications.\n  //\n  // Not configurable externally. Overwrite by forking.\n  wrappedEventHandlersOriginalFunctionStorageKey: string,\n\n  // Whether or not weasel should automatically wrap timers\n  // added via setTimeout / setInterval for improved uncaught error tracking.\n  // This results in improved uncaught error tracking for cross-origin\n  // errors, but may have adverse effects on website performance and\n  // stability.\n  //\n  // Set via:\n  // eum('wrapTimers', true)\n  wrapTimers: boolean,\n\n  // This key will be used by Weasel to privately store data on objects.\n  // Make sure to change this key when deploying Weasel in production.\n  secretPropertyKey: string,\n\n  // Weasel will not attempt automatic user tracking via cookies,\n  // fingerprinting or any other means. Instead, we give users the\n  // ability manually define user identifying properties. This means\n  // that Weasel can adapt to various data security & privacy\n  // settings.\n  //\n  // Set via:\n  // eum('user', 'userId', 'user name', 'email')\n  userId: ?string,\n  userName: ?string,\n  userEmail: ?string,\n\n  // Weasel by default does not collect session information as this\n  // has privacy policy implications. The session ID is a random\n  // value and does not make use of any fingerprinting mechanisms!\n  //\n  // Enable via:\n  // eum(\n  //   'trackSessions',\n  //   sessionInactivityTimeoutMillis: ?number = 21600000,  // six hours\n  //   sessionTerminationTimeoutMillis: ?number = 21600000  // six hours\n  // )\n  sessionId: ?string,\n\n  // Information about sessions will be stored under this name in\n  // localStorage or cookies whenever allowed by calling trackSessions.\n  //\n  // This value cannot be changed at runtime.\n  sessionStorageKey: string,\n\n  // The default session inactivity timeout. Session inactivity is the maximum\n  // allowed time to pass between two page loads before the session is considered\n  // to be expired. Also think of cache time-to-idle configuration options.\n  //\n  // This value cannot be changed at runtime.\n  defaultSessionInactivityTimeoutMillis: number,\n\n  // The default session termination timeout. Session termination is the maximum\n  // allowed time to pass since session start before the session is considered\n  // to be expired. Also think of cache time-to-live configuration options.\n  //\n  // This value cannot be changed at runtime.\n  defaultSessionTerminationTimeoutMillis: number,\n\n  // The maximum allowed value for either all session timeouts. Users can overwrite\n  // the defaults on a per page-load basis. We want to avoid abuse by protecting\n  // end-user from (near-) infinite timeouts.\n  //\n  // This value cannot be changed at runtime.\n  maxAllowedSessionTimeoutMillis: number,\n\n  // A set of regular expressions that will be matched against user timing\n  // mark and measure names. When any of the regular expressions match, then\n  // the user timing value will not be collected.\n  //\n  // eum('ignoreUserTimings', [/^\\u269B/, /^\\u26D4/]);\n  ignoreUserTimings: RegExp[],\n\n  // A set of regular expressions that will be matched against the first parameter\n  // of the `fetch` API, i.e. the relative or absolute request URL. By configuring\n  // this, you can decide which URLs Weasel we analyze for GraphQL specifics.\n  //\n  // eum('urlsToCheckForGraphQlInsights', [/\\/graphql/i]);\n  urlsToCheckForGraphQlInsights: RegExp[]\n} = {\n  nameOfLongGlobal: 'EumObject',\n  trackingSnippetVersion: null,\n  pageLoadTraceId: generateUniqueId(),\n  pageLoadBackendTraceId: null,\n  serverTimingBackendTraceIdEntryName: 'intid',\n  referenceTimestamp: now(),\n  highResTimestampReference: performance && performance.now ? performance.now() : 0,\n  initializerExecutionTimestamp: now(),\n  reportingUrl: 'http://169.53.56.203:30001/report',\n  beaconBatchingTime: 500,\n  maxWaitForResourceTimingsMillis: 10000,\n  maxMaitForPageLoadMetricsMillis: 5000,\n  apiKey: null,\n  meta: {},\n  ignoreUrls: [],\n  ignorePings: true,\n  ignoreErrorMessages: [],\n  xhrTransmissionTimeout: 20000,\n  allowedOrigins: ['*'],\n  page: undefined,\n  wrapEventHandlers: false,\n  wrappedEventHandlersOriginalFunctionStorageKey: '__weaselOriginalFunctions__',\n  wrapTimers: false,\n  secretPropertyKey: '__weaselSecretData__',\n  userId: undefined,\n  userName: undefined,\n  userEmail: undefined,\n  sessionId: undefined,\n  sessionStorageKey: 'session',\n  defaultSessionInactivityTimeoutMillis: 1000 * 60 * 60 * 3,\n  defaultSessionTerminationTimeoutMillis: 1000 * 60 * 60 * 6,\n  maxAllowedSessionTimeoutMillis:  1000 * 60 * 60 * 24,\n  // The default ignore rules cover specific React and Angular patterns:\n  //\n  // React has a whole lot of user timings. Luckily all of them start with\n  // the emojis for easy filtering. Let's ignore them by default as most of\n  // them won't be valuable to many of our users (in production).\n  //\n  // Similar for Angular which uses zones with a ton of custom user\n  // timings. https://angular.io/guide/zone\n  //\n  // We have also seen people use 'start xyz' / 'end xyz' as a common pattern to\n  // name marks used to create measures. This is surely not a comprehensive\n  // solution to identify these cases, but should for now be sufficient.\n  ignoreUserTimings: [/^\\u269B/, /^\\u26D4/, /^Zone(:|$)/, /^start /i, /^end /i],\n  urlsToCheckForGraphQlInsights: [/\\/graphql/i]\n};\n\nexport default defaultVars;\n","// @flow\n\nimport {pageLoad as pageLoadPhase} from '../phases';\nimport onLoadEvent from '../events/onLoad';\nimport type {State} from '../types';\nimport {transitionTo} from '../fsm';\nimport {on} from '../eventBus';\nimport vars from '../vars';\n\nconst state: State = {\n  onEnter() {\n    on(onLoadEvent.name, onLoad);\n    onLoadEvent.initialize();\n  },\n\n  getActiveTraceId() {\n    return vars.pageLoadTraceId;\n  },\n\n  getActivePhase() {\n    return pageLoadPhase;\n  }\n};\nexport default state;\n\nfunction onLoad() {\n  transitionTo('pageLoaded');\n}\n","import type {Beacon, Meta} from './types';\nimport {win, doc, nav} from './browser';\nimport {hasOwnProperty} from './util';\nimport {getActivePhase} from './fsm';\nimport {warn} from './debug';\nimport vars from './vars';\n\nconst maximumNumberOfMetaDataFields = 25;\nconst maximumLengthPerMetaDataField = 1024;\n\nconst languages = determineLanguages();\n\nexport function addCommonBeaconProperties(beacon: Beacon) {\n  beacon['k'] = vars.apiKey;\n  beacon['sv'] = vars.trackingSnippetVersion;\n  beacon['r'] = vars.referenceTimestamp;\n  beacon['p'] = vars.page;\n  beacon['l'] = win.location.href;\n  beacon['pl'] = vars.pageLoadTraceId;\n  beacon['ui'] = vars.userId;\n  beacon['un'] = vars.userName;\n  beacon['ue'] = vars.userEmail;\n  beacon['ul'] = languages;\n  beacon['ph'] = getActivePhase();\n  beacon['sid'] = vars.sessionId;\n  beacon['ww'] = win.innerWidth;\n  beacon['wh'] = win.innerHeight;\n  // Google Closure compiler is not yet aware of these globals. Make sure it doesn't\n  // mangle them.\n  if (nav['connection'] && nav['connection']['effectiveType']) {\n    beacon['ct'] = nav['connection']['effectiveType'];\n  }\n\n  if (doc.visibilityState) {\n    beacon['h'] = doc.visibilityState === 'hidden' ? 1 : 0;\n  }\n\n  addMetaDataToBeacon(beacon, vars.meta);\n}\n\nfunction determineLanguages() {\n  if (nav.languages && nav.languages.length > 0) {\n    return nav.languages.slice(0, 5).join(',');\n  }\n\n  if (typeof nav.userLanguage === 'string') {\n    return [nav.userLanguage].join(',');\n  }\n\n  return undefined;\n}\n\nexport function addMetaDataToBeacon(beacon: Beacon, meta: Meta) {\n  let i = 0;\n\n  for (let key in meta) {\n    if (hasOwnProperty(meta, key)) {\n      i++;\n      if (i > maximumNumberOfMetaDataFields) {\n        if (DEBUG) {\n          warn('Maximum number of meta data fields exceeded. Not all meta data fields will be transmitted.');\n        }\n        return;\n      }\n\n      let serializedValue = null;\n\n      if (typeof meta[key] === 'string') {\n        serializedValue = meta[key];\n      } else if (meta[key] === undefined) {\n        serializedValue = 'undefined';\n      } else if (meta[key] === null) {\n        serializedValue = 'null';\n      } else if (win.JSON) {\n        try {\n          serializedValue = win.JSON.stringify(meta[key]);\n        } catch (e) {\n          if (DEBUG) {\n            warn('JSON serialization of meta data',\n              key,\n              meta[key],\n              'failed due to',\n              e,\n              '. This value will not be transmitted.');\n          }\n          continue;\n        }\n      } else {\n        serializedValue = String(meta[key]);\n      }\n\n      beacon['m_' + key] = serializedValue.substring(0, maximumLengthPerMetaDataField);\n    }\n  }\n}\n","export const urlMaxLength = 255;\n\nexport const initiatorTypes = {\n  'other': 0,\n\n  'img': 1,\n  // IMAGE element inside a SVG\n  'image': 1,\n\n  'link': 2,\n  'script': 3,\n  'css': 4,\n\n  'xmlhttprequest': 5,\n  'fetch': 5,\n  'beacon': 5,\n\n  'html': 6,\n  'navigation': 6\n};\n\nexport const cachingTypes = {\n  unknown: 0,\n  cached: 1,\n  validated: 2,\n  fullLoad: 3\n};\n","// @flow\n\nimport { cachingTypes, initiatorTypes } from './consts';\nimport vars from '../vars';\n\nexport function serializeEntryToArray(entry: Object) {\n  const result = [\n    Math.round(entry['startTime'] - vars.highResTimestampReference),\n    Math.round(entry['duration']),\n    initiatorTypes[entry['initiatorType']] || initiatorTypes['other']\n  ];\n\n  // When timing data is available, we can provide additional information about\n  // caching and resource sizes.\n  if (typeof entry['transferSize'] === 'number' &&\n      typeof entry['encodedBodySize'] === 'number' &&\n      // All this information may not be available due to the timing allow origin check.\n      entry['encodedBodySize'] > 0) {\n    if (entry['transferSize'] === 0) {\n      result.push(cachingTypes.cached);\n    } else if (entry['transferSize'] > 0 && (entry['encodedBodySize'] === 0 || entry['transferSize'] < entry['encodedBodySize'])) {\n      result.push(cachingTypes.validated);\n    } else {\n      result.push(cachingTypes.fullLoad);\n    }\n\n    if (entry['encodedBodySize'] != null) {\n      result.push(entry['encodedBodySize']);\n    } else {\n      result.push('');\n    }\n    if (entry['decodedBodySize'] != null) {\n      result.push(entry['decodedBodySize']);\n    } else {\n      result.push('');\n    }\n    if (entry['transferSize'] != null) {\n      result.push(entry['transferSize']);\n    } else {\n      result.push('');\n    }\n  } else {\n    result.push('');\n    result.push('');\n    result.push('');\n    result.push('');\n  }\n\n  const hasValidTimings = entry['responseStart'] != null &&\n    // timing allow origin check may have failed\n    entry['responseStart'] >= entry['fetchStart'];\n  if (hasValidTimings) {\n    result.push(calculateTiming(entry['redirectEnd'], entry['redirectStart']));\n    result.push(calculateTiming(entry['domainLookupStart'], entry['fetchStart']));\n    result.push(calculateTiming(entry['domainLookupEnd'], entry['domainLookupStart']));\n    if (entry['connectStart'] > 0 && entry['connectEnd'] > 0) {\n      if (entry['secureConnectionStart'] != null && entry['secureConnectionStart'] > 0) {\n        result.push(calculateTiming(entry['secureConnectionStart'], entry['connectStart']));\n        result.push(calculateTiming(entry['connectEnd'], entry['secureConnectionStart']));\n      } else {\n        result.push(calculateTiming(entry['connectEnd'], entry['connectStart']));\n        result.push('');\n      }\n    } else {\n      result.push('');\n      result.push('');\n    }\n    result.push(calculateTiming(entry['responseStart'], entry['requestStart']));\n    result.push(calculateTiming(entry['responseEnd'], entry['responseStart']));\n  }\n\n  let backendTraceId = '';\n  try {\n    const serverTimings = entry['serverTiming'];\n    if (serverTimings instanceof Array) {\n      for (let i = 0; i < serverTimings.length; i++) {\n        const serverTiming = serverTimings[i];\n        if (serverTiming['name'] === vars.serverTimingBackendTraceIdEntryName) {\n          backendTraceId = serverTiming['description'];\n        }\n      }\n    }\n  } catch (e) {\n    // Some browsers may not grant access to the field when the Timing-Allow-Origin\n    // check fails. Better be safe than sorry here.\n  }\n  result.push(backendTraceId);\n\n  if (hasValidTimings) {\n    result.push(calculateTiming(entry['responseStart'], entry['startTime']));\n  } else {\n    result.push('');\n  }\n\n  return result;\n}\n\nexport function serializeEntry(entry: PerformanceEntry) {\n  return serializeEntryToArray(entry).join(',')\n    // remove empty trailing timings\n    .replace(/,+$/, '');\n}\n\nfunction calculateTiming(a: ?number, b: ?number) {\n  if (a == null || b == null ||\n      // the values being equal indicates for example that a network connection didn't need\n      // to be established. Do not report a timing of '0' as this will skew the statistics.\n      a === b) {\n    return '';\n  }\n  const diff = Math.round(a - b);\n  if (diff < 0) {\n    return '';\n  }\n  return diff;\n}\n","// @flow\n\nimport {matchesAny} from './util';\nimport vars from './vars';\n\nconst dataUrlPrefix = 'data:';\nconst ignorePingsRegex = /.*\\/ping(\\/?$|\\?.*)/i;\n\nexport function isUrlIgnored(url: ?string|?number): boolean {\n  if (!url) {\n    return true;\n  }\n\n  // Force string conversion. During runtime we have seen that some URLs passed into this code path aren't actually\n  // strings. Reason currently unknown.\n  url = String(url);\n  if (!url) {\n    return true;\n  }\n\n  // We never want to track data URLs. Instead of matching these via regular expressions (which might be expensive),\n  // we are explicitly doing a startsWith ignore case check\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\n  if (url.substring == null || url.substring(0, dataUrlPrefix.length).toLowerCase() === dataUrlPrefix) {\n    return true;\n  }\n\n  if (vars.ignorePings && ignorePingsRegex.test(url)) {\n    return true;\n  }\n\n  // Disable monitoring of data transmission requests. The data transmission strategy already ensures\n  // that data transmission requests are not picked up internally. However we have seen some users\n  // leverage custom (broken) XMLHttpRequest instrumentations to implement application code which\n  // then break the detection of data transmission requests.\n  if (vars.reportingUrl && (url === vars.reportingUrl || url === vars.reportingUrl + '/')) {\n    return true;\n  }\n\n  return matchesAny(vars.ignoreUrls, url);\n}\n\nexport function isErrorMessageIgnored(message: ?string) {\n  return !message || matchesAny(vars.ignoreErrorMessages, message);\n}\n","import {hasOwnProperty} from './util';\n\nconst INTERNAL_END_MARKER = '<END>';\n\nexport function createTrie() {\n  return new Trie();\n}\n\nfunction Trie() {\n  this.root = {};\n}\n\nTrie.prototype.addItem = function addItem(key, value) {\n  this.insertItem(this.root, key.split(''), 0, value);\n  return this;\n};\n\nTrie.prototype.insertItem = function insertItem(node, keyCharacters, keyCharacterIndex, value) {\n  const character = keyCharacters[keyCharacterIndex];\n  // Characters exhausted, add value to node\n  if (character == null) {\n    const values = node[INTERNAL_END_MARKER] = node[INTERNAL_END_MARKER] || [];\n    values.push(value);\n    return;\n  }\n\n  const nextNode = node[character] = node[character] || {};\n  this.insertItem(nextNode, keyCharacters, keyCharacterIndex + 1, value);\n};\n\nTrie.prototype.toJs = function toJs(node) {\n  node = node || this.root;\n\n  const keys = getKeys(node);\n  if (keys.length === 1 && keys[0] === INTERNAL_END_MARKER) {\n    return node[INTERNAL_END_MARKER].slice();\n  }\n\n  const result = {};\n\n  for (let i = 0, length = keys.length; i < length ;i++) {\n    const key = keys[i];\n    const value = node[key];\n    if (key === INTERNAL_END_MARKER) {\n      result['$'] = value.slice();\n      continue;\n    }\n\n    let combinedKeys = key;\n    let child = node[key];\n    let childKeys = getKeys(child);\n    while (childKeys.length === 1 && childKeys[0] !== INTERNAL_END_MARKER) {\n      combinedKeys += childKeys[0];\n      child = child[childKeys[0]];\n      childKeys = getKeys(child);\n    }\n\n    result[combinedKeys] = this.toJs(child);\n  }\n\n  return result;\n};\n\nfunction getKeys(obj) {\n  const result = [];\n\n  for (let key in obj) {\n    if (hasOwnProperty(obj, key)) {\n      result.push(key);\n    }\n  }\n\n  return result;\n}\n","// @flow\n\nimport {performance, isResourceTimingAvailable} from '../performance';\nimport type {BeaconWithResourceTiming} from '../types';\nimport {serializeEntry} from './timingSerializer';\nimport {isUrlIgnored} from '../ignoreRules';\nimport {urlMaxLength} from './consts';\nimport {createTrie} from '../trie';\nimport {win} from '../browser';\nimport {info} from '../debug';\nimport vars from '../vars';\n\n// See https://w3c.github.io/resource-timing/\n// See https://www.w3.org/TR/hr-time/\n\nexport function addResourceTimings(beacon: BeaconWithResourceTiming, minStartTime: ?number) {\n  if (isResourceTimingAvailable && win.JSON) {\n    const entries = getEntriesTransferFormat(performance.getEntriesByType('resource'), minStartTime);\n    beacon['res'] = win.JSON.stringify(entries);\n  } else if (DEBUG) {\n    info('Resource timing not supported.');\n  }\n}\n\n\nfunction getEntriesTransferFormat(performanceEntries: Array<Object>, minStartTime: ?number) {\n  const trie = createTrie();\n  const lowerCaseReportingUrl = vars.reportingUrl != null ? vars.reportingUrl.toLowerCase() : null;\n\n  for (let i = 0, len = performanceEntries.length; i < len; i++) {\n    const entry = performanceEntries[i];\n    if (minStartTime != null &&\n        (entry['startTime'] - vars.highResTimestampReference + vars.referenceTimestamp) < minStartTime) {\n      continue;\n    } else if (entry['duration'] < 0) {\n      // Some old browsers do not properly implement resource timing. They report negative durations.\n      // Ignore instead of reporting these, as the data isn't usable.\n      continue;\n    }\n\n    let url = entry.name;\n    if (isUrlIgnored(url)) {\n      if (DEBUG) {\n        info('Will not include data about resource because resource URL is ignored via ignore rules.', entry);\n      }\n      continue;\n    }\n\n    const lowerCaseUrl = url.toLowerCase();\n    const initiatorType = entry['initiatorType'];\n    if (lowerCaseUrl === 'about:blank' || lowerCaseUrl.indexOf('javascript:') === 0 || // some iframe cases\n      // Data transmission can be visible as a resource. Do not report it.\n      (lowerCaseReportingUrl != null && lowerCaseUrl.indexOf(lowerCaseReportingUrl) === 0)) {\n      continue;\n    }\n\n    if (url.length > urlMaxLength) {\n      url = url.substring(0, urlMaxLength);\n    }\n\n    // We provide more detailed XHR insights via our XHR instrumentation.\n    // The XHR instrumentation is available once the initialization was executed\n    // (which is completely synchronous).\n    if (initiatorType !== 'xmlhttprequest' || entry['startTime'] < vars.highResTimestampReference) {\n      trie.addItem(url, serializeEntry(entry));\n    }\n  }\n\n  return trie.toJs();\n}\n","// @flow\n\nimport {performance, isTimingAvailable, isResourceTimingAvailable} from './performance';\nimport type {PageLoadBeacon} from './types';\nimport onLoadEvent from './events/onLoad';\nimport {win} from './browser';\nimport vars from './vars';\n\n// See spec:\n// https://www.w3.org/TR/navigation-timing/\n\nexport const pageLoadStartTimestamp = getPageLoadStartTimestamp();\n\nfunction getPageLoadStartTimestamp() {\n  if (!isTimingAvailable) {\n    return vars.initializerExecutionTimestamp;\n  }\n  return performance.timing.navigationStart;\n}\n\nexport function addTimingToPageLoadBeacon(beacon: PageLoadBeacon) {\n  if (!isTimingAvailable) {\n    // This is our absolute fallback mode where we only have\n    // approximations for speed information.\n    beacon['ts'] = pageLoadStartTimestamp - vars.referenceTimestamp;\n    beacon['d'] = Number(onLoadEvent.time) - vars.initializerExecutionTimestamp;\n\n    // We add this as an extra property to the beacon so that\n    // a backend can decide whether it should include timing\n    // information in aggregated metrics. Since they are only\n    // approximations, this is not always desirable.\n    if (!isTimingAvailable) {\n      beacon['tim'] = '0';\n    }\n\n    return;\n  }\n\n  const timing = performance.timing;\n\n  const redirectTime = timing.redirectEnd - timing.redirectStart;\n  // We don't use navigationStart since that includes unload times for the previous page.\n  const start = pageLoadStartTimestamp;\n  beacon['ts'] = start - vars.referenceTimestamp;\n\n  // This can happen when the user aborts the page load. In this case, the load event\n  // timing information is not available and will have the default value of \"0\".\n  if (timing.loadEventStart > 0) {\n    beacon['d'] = timing.loadEventStart - (timing.fetchStart || timing.navigationStart);\n  } else {\n    beacon['d'] = Number(onLoadEvent.time) - vars.initializerExecutionTimestamp;\n\n    // We have partial timing information, but since the load was aborted, we will\n    // mark it as missing to indicate that the information should be ignored in\n    // statistics.\n    beacon['tim'] = '0';\n  }\n\n  beacon['t_unl'] = timing.unloadEventEnd - timing.unloadEventStart;\n  beacon['t_red'] = redirectTime;\n  beacon['t_apc'] = timing.domainLookupStart - (timing.fetchStart || timing.redirectEnd || timing.unloadEventEnd || timing.navigationStart);\n  beacon['t_dns'] = timing.domainLookupEnd - timing.domainLookupStart;\n  if (timing.connectStart > 0 && timing.connectEnd > 0) {\n    if (timing.secureConnectionStart != null\n        && timing.secureConnectionStart > 0\n        // Issue in the navigation timing spec: Secure connection start does not take\n        // connection reuse into consideration. At the time of writing (2020-07-11)\n        // the latest W3C Navigation Timing recommendation still contains this issue.\n        // The latest editor draft has these fixed (by linking to the resource timing\n        // spec instead of duplicating the information).\n        // For now a workaround to avoid these wrong timings seems to be the following.\n        && timing.secureConnectionStart >= timing.connectStart) {\n      beacon['t_tcp'] = timing.secureConnectionStart - timing.connectStart;\n      beacon['t_ssl'] = timing.connectEnd - timing.secureConnectionStart;\n    } else {\n      beacon['t_tcp'] = timing.connectEnd - timing.connectStart;\n      beacon['t_ssl'] = 0;\n    }\n  }\n  beacon['t_req'] = timing.responseStart - timing.requestStart;\n  beacon['t_rsp'] = timing.responseEnd - timing.responseStart;\n  beacon['t_dom'] = timing.domContentLoadedEventStart - timing.domLoading;\n  beacon['t_chi'] = timing.loadEventEnd - timing.domContentLoadedEventStart;\n  beacon['t_bac'] = timing.responseStart - start;\n  beacon['t_fro'] = timing.loadEventEnd - timing.responseStart;\n  beacon['t_pro'] = timing.loadEventStart - timing.domLoading;\n  beacon['t_loa'] = timing.loadEventEnd - timing.loadEventStart;\n  beacon['t_ttfb'] = timing.responseStart - start;\n\n  addFirstPaintTimings(beacon, start);\n}\n\n\nfunction addFirstPaintTimings(beacon: PageLoadBeacon, start: number) {\n  if (!isResourceTimingAvailable) {\n    addFirstPaintFallbacks(beacon, start);\n    return;\n  }\n\n  const paintTimings = performance.getEntriesByType('paint');\n  let firstPaintFound = false;\n  for (let i = 0; i < paintTimings.length; i++) {\n    const paintTiming = paintTimings[i];\n    switch (paintTiming.name) {\n    case 'first-paint':\n      beacon['t_fp'] = paintTiming.startTime | 0;\n      firstPaintFound = true;\n      break;\n\n    case 'first-contentful-paint':\n      beacon['t_fcp'] = paintTiming.startTime | 0;\n      break;\n    }\n  }\n\n  if (!firstPaintFound) {\n    addFirstPaintFallbacks(beacon, start);\n  }\n}\n\nfunction addFirstPaintFallbacks(beacon: PageLoadBeacon, start: number) {\n  let firstPaint = null;\n\n  // Chrome\n  if (win.chrome && win.chrome.loadTimes) {\n    // Convert to ms\n    firstPaint = win.chrome.loadTimes()['firstPaintTime'] * 1000;\n  }\n  // IE\n  else if (typeof win.performance.timing['msFirstPaint'] === 'number') {\n    firstPaint = win.performance.timing['msFirstPaint'];\n  }\n  // standard\n  else if (typeof win.performance.timing['firstPaint'] === 'number') {\n    firstPaint = win.performance.timing['firstPaint'];\n  }\n\n  // First paint may not be available -OR- the browser may have never\n  // painted anything and thereby kept this value at 0.\n  if (firstPaint != null && firstPaint !== 0) {\n    beacon['t_fp'] = Math.round(firstPaint - start);\n  }\n}\n","// @flow\n\nimport { addEventListener } from '../util';\nimport { doc, win } from '../browser';\n\n// Defined here until https://github.com/facebook/flow/pull/8371 is merged and released.\nclass PageTransitionEvent extends Event {\n  persisted: boolean;\n}\n\nlet isUnloading = false;\n\nexport function onLastChance(fn: Function) {\n  if (isUnloading) {\n    fn();\n  }\n\n  addEventListener(doc, 'visibilitychange', function() {\n    if (doc.visibilityState !== 'visible') {\n      fn();\n    }\n  });\n\n  // $FlowFixMe The type is correct, but flow doesn't think so. Ignore for now.\n  addEventListener(win, 'pagehide', function(event: PageTransitionEvent) {\n    if (event.persisted) {\n      isUnloading = true;\n      fn();\n    }\n  });\n\n  // Unload is needed to fix this bug:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=987409\n  addEventListener(win, 'unload', function() {});\n\n  // According to the spec visibilitychange should be a replacement for\n  // beforeunload, but the reality is different (as of 2019-04-17). Chrome will\n  // close tabs without firing visibilitychange. beforeunload on the other hand\n  // is fired.\n  addEventListener(win, 'beforeunload', function() {\n    isUnloading = true;\n    fn();\n  });\n}\n","import {serializeEntryToArray} from '../resources/timingSerializer';\nimport type {XhrBeacon} from '../types';\nimport vars from '../vars';\n\n/*\n * This file exists to resolve circular dependencies between\n * lib/transmission/index.js -> lib/transmission/batched.js -> lib/hooks/XMLHttpRequest.js -> lib/transmission/index.js\n */\n\nexport function disableMonitoringForXMLHttpRequest(xhr: XMLHttpRequest): void {\n  const state = xhr[vars.secretPropertyKey] = xhr[vars.secretPropertyKey] || {};\n  state.ignored = true;\n}\n\nexport function addResourceTiming(beacon: XhrBeacon, resource: PerformanceEntry) {\n  const timings = serializeEntryToArray(resource);\n\n  beacon['s_ty'] = getTimingValue(timings[3]);\n  beacon['s_eb'] = getTimingValue(timings[4]);\n  beacon['s_db'] = getTimingValue(timings[5]);\n  beacon['s_ts'] = getTimingValue(timings[6]);\n  beacon['t_red'] = getTimingValue(timings[7]);\n  beacon['t_apc'] = getTimingValue(timings[8]);\n  beacon['t_dns'] = getTimingValue(timings[9]);\n  beacon['t_tcp'] = getTimingValue(timings[10]);\n  beacon['t_ssl'] = getTimingValue(timings[11]);\n  beacon['t_req'] = getTimingValue(timings[12]);\n  beacon['t_rsp'] = getTimingValue(timings[13]);\n  if (timings[14]) {\n    beacon['bt'] = timings[14];\n    beacon['bc'] = 1;\n  }\n  beacon['t_ttfb'] = getTimingValue(timings[15]);\n}\n\nfunction getTimingValue(timing: any) {\n  if (typeof timing === 'number') {\n    return timing;\n  }\n  return undefined;\n}\n\nexport function addCorrelationHttpHeaders(fn, ctx, traceId) {\n  fn.call(ctx, 'X-INSTANA-T', traceId);\n  fn.call(ctx, 'X-INSTANA-S', traceId);\n  fn.call(ctx, 'X-INSTANA-L', '1,correlationType=web;correlationId=' + traceId);\n}\n","// @flow\n\nimport {hasOwnProperty} from '../util';\n\n// We know that must values are plain key/value pairs. We therefore choose a format that is\n// very easy to parse in a streaming fashion on the server-side. This format is a basic\n// line-based encoding of key/value pairs. Each line contains a key/value pair.\n//\n// In contrast to form encoding, this encoding handles JSON much better.\nexport function encode(beacons: Array<Object>): string {\n  let str = '';\n\n  for (let i = 0; i < beacons.length; i++) {\n    const beacon = beacons[i];\n\n    // Multiple beacons are separated by an empty line\n    str += '\\n';\n\n    for (let key in beacon) {\n      if (hasOwnProperty(beacon, key)) {\n        const value = beacon[key];\n        if (value != null) {\n          str += '\\n' + encodePart(key) + '\\t' + encodePart(value);\n        }\n      }\n    }\n  }\n\n  return str.substring(2);\n}\n\nfunction encodePart(part: any) {\n  return String(part)\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/\\n/g, '\\\\n')\n    .replace(/\\t/g, '\\\\t');\n}\n","// @flow\n\nimport { doc, nav, XMLHttpRequest, sendBeacon as sendBeaconInternal } from '../browser';\nimport { disableMonitoringForXMLHttpRequest } from '../hooks/xhrHelpers';\nimport {onLastChance} from '../events/onLastChance';\nimport {setTimeout, clearTimeout} from '../timers';\nimport { encode } from './lineEncoding';\nimport type { Beacon } from '../types';\nimport vars from '../vars';\n\nconst maxBatchedBeacons = 15;\n\nconst pendingBeacons: Array<Beacon> = [];\nlet pendingBeaconTransmittingTimeout;\n\nconst isVisibilityApiSupported = typeof doc.visibilityState === 'string';\nconst isSupported = !!XMLHttpRequest && isVisibilityApiSupported && isSendBeaconApiSupported();\n\nexport function isEnabled() {\n  return isSupported && vars.beaconBatchingTime > 0;\n}\n\n// We attempt batching of messages to be more efficient on the client, network and\n// server-side. While the connection is either a persistent HTTP 2 connection or\n// a HTTP 1.1 connection with keep-alive, there is still some overhead involved\n// in having many small messages.\n//\n// For this reason we attempt batching. When batching we must be careful to\n// force a transmission when the document is unloaded.\nif (isSupported) {\n  onLastChance(transmit);\n}\n\nexport function sendBeacon(beacon: Beacon) {\n  pendingBeacons.push(beacon);\n\n  if (pendingBeacons.length >= maxBatchedBeacons) {\n    transmit();\n  } else if (!isWindowHidden() && vars.beaconBatchingTime > 0) {\n    // We cannot guarantee that we will ever get time to transmit data in a batched\n    // format when the window is hidden, as this might occur while the document is\n    // being unloaded. Immediately force a transmission in these cases.\n    if (pendingBeaconTransmittingTimeout == null) {\n      pendingBeaconTransmittingTimeout = setTimeout(transmit, vars.beaconBatchingTime);\n    }\n  } else {\n    transmit();\n  }\n}\n\nfunction transmit() {\n  if (pendingBeaconTransmittingTimeout != null) {\n    clearTimeout(pendingBeaconTransmittingTimeout);\n    pendingBeaconTransmittingTimeout = null;\n  }\n\n  if (pendingBeacons.length === 0) {\n    return;\n  }\n\n  const serializedBeacons = encode(pendingBeacons);\n  // clear the array\n  pendingBeacons.length = 0;\n\n  // Empty beacons. Should never happen, but better be safe.\n  if (serializedBeacons.length === 0) {\n    return;\n  }\n\n  // This will transmit a text/plain;charset=UTF-8 content type. This may not be what we\n  // want, but changing the content type via the Blob constructor currently\n  // breaks for cross-origin requests.\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=490015\n  const sendBeaconState = isSendBeaconApiSupported() && sendBeaconInternal(String(vars.reportingUrl), serializedBeacons);\n\n  // There are limits to the amount of data transmittable via the sendBeacon API.\n  // If it doesn't work via the sendBeacon, try it via plain old AJAX APIs\n  // as a last resort.\n  if (sendBeaconState === false) {\n    const xhr = new XMLHttpRequest();\n    disableMonitoringForXMLHttpRequest(xhr);\n    xhr.open('POST', String(vars.reportingUrl), true);\n    xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n    // Ensure that browsers do not try to automatically parse the response.\n    xhr.responseType = 'text';\n    xhr.timeout = vars.xhrTransmissionTimeout;\n    xhr.send(serializedBeacons);\n  }\n}\n\nfunction isWindowHidden() {\n  return doc.visibilityState !== 'visible';\n}\n\nfunction isSendBeaconApiSupported() {\n  return typeof nav.sendBeacon === 'function';\n}\n","// @flow\n\nimport {setInterval} from './timers';\n\nexport function createExcessiveUsageIdentifier(opts: {\n  maxCalls?: number,\n  maxCallsPerTenMinutes: number,\n  maxCallsPerTenSeconds: number\n}) {\n  const maxCalls = opts.maxCalls || 4096;\n  const maxCallsPerTenMinutes = opts.maxCallsPerTenMinutes || 128;\n  const maxCallsPerTenSeconds = opts.maxCallsPerTenSeconds || 32;\n\n  let totalCalls = 0;\n  let totalCallsInLastTenMinutes = 0;\n  let totalCallsInLastTenSeconds = 0;\n\n  setInterval(function() {\n    totalCallsInLastTenMinutes = 0;\n  }, 1000 * 60 * 10);\n\n  setInterval(function() {\n    totalCallsInLastTenSeconds = 0;\n  }, 1000 * 10);\n\n  return function isExcessiveUsage() {\n    return (\n      ++totalCalls > maxCalls ||\n      ++totalCallsInLastTenMinutes > maxCallsPerTenMinutes ||\n      ++totalCallsInLastTenSeconds > maxCallsPerTenSeconds\n    );\n  };\n}\n","// @flow\n\nimport {XMLHttpRequest, encodeURIComponent, executeImageRequest} from '../browser';\nimport { disableMonitoringForXMLHttpRequest } from '../hooks/xhrHelpers';\nimport {hasOwnProperty} from '../util';\nimport type {Beacon} from '../types';\nimport vars from '../vars';\n\nconst maxLengthForImgRequest = 2000;\n\nexport function sendBeacon(data: Beacon) {\n  const str = stringify(data);\n  if (str.length === 0) {\n    return;\n  }\n\n  if (XMLHttpRequest && str.length > maxLengthForImgRequest) {\n    const xhr = new XMLHttpRequest();\n    disableMonitoringForXMLHttpRequest(xhr);\n    xhr.open('POST', String(vars.reportingUrl), true);\n    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n    // Ensure that browsers do not try to automatically parse the response.\n    xhr.responseType = 'text';\n    xhr.timeout = vars.xhrTransmissionTimeout;\n    xhr.send(str);\n  } else {\n    // Older browsers do not support the XMLHttpRequest API. This sucks and may\n    // result in a variety of issues, e.g. URL length restrictions. \"Luckily\", older\n    // browsers also lack support for advanced features such as resource timing.\n    // This should make this transmission via a GET request possible.\n    executeImageRequest(String(vars.reportingUrl) + '?' + str);\n  }\n}\n\nfunction stringify(data: Beacon) {\n  let str = '';\n\n  for (let key in data) {\n    if (hasOwnProperty(data, key)) {\n      const value = data[key];\n      if (value != null) {\n        str += '&' + encodeURIComponent(key) + '=' + encodeURIComponent(String(data[key]));\n      }\n    }\n  }\n\n  return str.substring(1);\n}\n","// @flow\n\nimport { sendBeacon as sendBatchedBeacon, isEnabled as isBatchingEnabled } from './batched';\nimport {createExcessiveUsageIdentifier} from '../excessiveUsageIdentification';\nimport { sendBeacon as sendFormEncodedBeacon } from './formEncoded';\nimport {isUrlIgnored} from '../ignoreRules';\nimport type {Beacon} from '../types';\nimport {info, error} from '../debug';\n\nconst isExcessiveUsage = createExcessiveUsageIdentifier({\n  maxCalls: 8096,\n  maxCallsPerTenMinutes: 4096,\n  maxCallsPerTenSeconds: 128\n});\n\nexport function sendBeacon(data: Beacon) {\n  if (isUrlIgnored(data['l'])) {\n    // data['l'] is a standardized property across all beacons to ensure that we do not accidentally transmit data\n    // about a page such as this.\n\n    if (DEBUG) {\n      info('Skipping transmission of beacon because document URL associated to the beacon is ignored by ignore rule.', data);\n    }\n    return;\n  }\n\n  if (DEBUG) {\n    info('Transmitting beacon', data);\n  }\n\n  if (isExcessiveUsage()) {\n    if (DEBUG) {\n      info('Reached the maximum number of beacons to transmit.');\n    }\n    return;\n  }\n\n  try {\n    if (isBatchingEnabled()) {\n      sendBatchedBeacon(data);\n    } else {\n      sendFormEncodedBeacon(data);\n    }\n  } catch (e) {\n    if (DEBUG) {\n      error('Failed to transmit beacon', e);\n    }\n  }\n}\n","// @flow\n\nimport {addCommonBeaconProperties} from '../commonBeaconProperties';\nimport {addResourceTimings} from '../resources/resources';\nimport {addTimingToPageLoadBeacon} from '../timings';\nimport {pageLoad as pageLoadPhase} from '../phases';\nimport type {State, PageLoadBeacon} from '../types';\nimport {onLastChance} from '../events/onLastChance';\nimport {sendBeacon} from '../transmission/index';\nimport {setTimeout} from '../timers';\nimport {win, doc} from '../browser';\nimport {info} from '../debug';\nimport vars from '../vars';\n\n// Export\n// $FlowFixMe: Find a way to define all properties beforehand so that flow doesn't complain about missing props.\nexport const beacon: PageLoadBeacon = {\n  'ty': 'pl'\n};\n\nconst state: State = {\n  onEnter() {\n    addCommonBeaconProperties(beacon);\n\n    beacon['t'] = vars.pageLoadTraceId;\n    beacon['bt'] = vars.pageLoadBackendTraceId;\n    beacon['u'] = win.location.href;\n    beacon['ph'] = pageLoadPhase;\n\n    addTimingToPageLoadBeacon(beacon);\n    addResourceTimings(beacon);\n\n    let beaconSent = false;\n    if (doc.visibilityState !== 'visible') {\n      if (DEBUG) {\n        info('Will not wait for additional page load beacon data because document.visibilityState is', doc.visibilityState);\n      }\n      sendPageLoadBeacon();\n      return;\n    }\n\n    setTimeout(sendPageLoadBeacon, vars.maxMaitForPageLoadMetricsMillis);\n    onLastChance(sendPageLoadBeacon);\n\n    function sendPageLoadBeacon() {\n      if (!beaconSent) {\n        beaconSent = true;\n        sendBeacon(beacon);\n      }\n    }\n  },\n\n  getActiveTraceId() {\n    return null;\n  },\n\n  getActivePhase() {\n    return undefined;\n  }\n};\nexport default state;\n\n","// @flow\n\nimport {addCommonBeaconProperties, addMetaDataToBeacon} from '../commonBeaconProperties';\nimport type {UnhandledErrorBeacon, ReportErrorOpts, Meta} from '../types';\nimport {isErrorMessageIgnored} from '../ignoreRules';\nimport {setTimeout, clearTimeout} from '../timers';\nimport {sendBeacon} from '../transmission/index';\nimport {now, generateUniqueId} from '../util';\nimport {getActiveTraceId} from '../fsm';\nimport {win} from '../browser';\n\ntype TrackedError = {\n  message: string,\n  stack: string,\n  componentStack: ?string,\n  meta: ?Meta,\n  location: string,\n  parentId: ?string,\n  seenCount: number,\n  transmittedCount: number\n}\n\nconst maxErrorsToReport = 100;\nconst maxStackSize = 30;\n\nlet reportedErrors = 0;\nconst maxSeenErrorsTracked = 20;\nlet numberOfDifferentErrorsSeen = 0;\nlet seenErrors: {[key: string]: TrackedError} = {};\nlet scheduledTransmissionTimeoutHandle;\n\n// We are wrapping global listeners. In these, we are catching and rethrowing errors.\n// In older browsers, rethrowing errors actually manipulates the error objects. As a\n// result, it is not possible to just mark an error as reported. The simplest way to\n// avoid double reporting is to temporarily disable the global onError handlerâ€¦\nlet ignoreNextOnError = false;\n\nexport function ignoreNextOnErrorEvent() {\n  ignoreNextOnError = true;\n}\n\nexport function hookIntoGlobalErrorEvent() {\n  let globalOnError = win.onerror;\n\n  win.onerror = function(message, fileName, lineNumber, columnNumber, error) {\n    if (ignoreNextOnError) {\n      ignoreNextOnError = false;\n      if (typeof globalOnError === 'function') {\n        return globalOnError.apply(this, arguments);\n      }\n      return;\n    }\n\n    let stack = error && error.stack;\n    if (!stack) {\n      stack = 'at ' + fileName + ' ' + lineNumber;\n      if (columnNumber != null) {\n        stack += ':' + columnNumber;\n      }\n    }\n    onUnhandledError(message, stack);\n\n    if (typeof globalOnError === 'function') {\n      return globalOnError.apply(this, arguments);\n    }\n  };\n}\n\nexport function reportError(error: string | ErrorLike, opts: ?ReportErrorOpts) {\n  if (!error) {\n    return;\n  }\n\n  if (typeof error === 'string') {\n    onUnhandledError(error, '', opts);\n  } else {\n    onUnhandledError(error['message'], error['stack'], opts);\n  }\n}\n\nfunction onUnhandledError(message, stack, opts: ?ReportErrorOpts) {\n  if (!message || reportedErrors > maxErrorsToReport) {\n    return;\n  }\n\n  if (isErrorMessageIgnored(message)) {\n    return;\n  }\n\n  if (numberOfDifferentErrorsSeen >= maxSeenErrorsTracked) {\n    seenErrors = {};\n    numberOfDifferentErrorsSeen = 0;\n  }\n\n  message = String(message).substring(0, 300);\n  stack = shortenStackTrace(stack);\n  const location = win.location.href;\n  const parentId: ?string = getActiveTraceId();\n  const key = message + stack + location + (parentId || '');\n\n  let trackedError = seenErrors[key];\n  if (trackedError) {\n    trackedError.seenCount++;\n  } else {\n    let componentStack = undefined;\n    if (opts && opts['componentStack']) {\n      componentStack = String(opts['componentStack']).substring(0, 4096);\n    }\n\n    trackedError = seenErrors[key] = {\n      message,\n      stack,\n      componentStack,\n      // $FlowFixMe Flow assumes that this value can be a string due to the bracket notation.\n      meta: opts ? opts['meta'] : undefined,\n      location,\n      parentId,\n      seenCount: 1,\n      transmittedCount: 0\n    };\n    numberOfDifferentErrorsSeen++;\n  }\n\n  scheduleTransmission();\n}\n\nexport function shortenStackTrace(stack: ?string): string {\n  return String(stack || '').split('\\n').slice(0, maxStackSize).join('\\n');\n}\n\nfunction scheduleTransmission() {\n  if (scheduledTransmissionTimeoutHandle) {\n    return;\n  }\n\n  scheduledTransmissionTimeoutHandle = setTimeout(send, 1000);\n}\n\n\nfunction send() {\n  clearTimeout(scheduledTransmissionTimeoutHandle);\n  scheduledTransmissionTimeoutHandle = null;\n\n  for (let key in seenErrors) {\n    if (seenErrors.hasOwnProperty(key)) {\n      const seenError = seenErrors[key];\n      if (seenError.seenCount > seenError.transmittedCount) {\n        sendBeaconForError(seenError);\n        reportedErrors++;\n      }\n    }\n  }\n\n  seenErrors = {};\n  numberOfDifferentErrorsSeen = 0;\n}\n\n\nfunction sendBeaconForError(error) {\n  const spanId = generateUniqueId();\n  const traceId = error.parentId || spanId;\n  // $FlowFixMe\n  const beacon: UnhandledErrorBeacon = {\n    'ty': 'err',\n\n    's': spanId,\n    't': traceId,\n    'ts': now(),\n\n    // error beacon specific data\n    'l': error.location,\n    'e': error.message,\n    'st': error.stack,\n    'cs': error.componentStack,\n    'c': error.seenCount - error.transmittedCount\n  };\n  addCommonBeaconProperties(beacon);\n  if (error.meta) {\n    addMetaDataToBeacon(beacon, error.meta);\n  }\n  sendBeacon(beacon);\n}\n","// @flow\n\nimport {reportError} from './unhandledError';\nimport {win} from '../browser';\n\nconst messagePrefix = 'Unhandled promise rejection: ';\nconst stackUnavailableMessage = '<unavailable because Promise wasn\\'t rejected with an Error object>';\n\nexport function hookIntoGlobalUnhandledRejectionEvent() {\n  if (typeof win.addEventListener === 'function') {\n    win.addEventListener('unhandledrejection', onUnhandledRejection);\n  }\n}\n\nexport function onUnhandledRejection(event: PromiseRejectionEvent) {\n  if (event.reason == null) {\n    reportError({\n      message: messagePrefix + '<no reason defined>',\n      stack: stackUnavailableMessage\n    });\n  } else if (typeof event.reason.message === 'string') {\n    reportError({\n      message: messagePrefix + event.reason.message,\n      stack: typeof event.reason.stack === 'string' ? event.reason.stack : stackUnavailableMessage\n    });\n  } else if (typeof event.reason !== 'object') {\n    reportError({\n      message: messagePrefix + event.reason,\n      stack: stackUnavailableMessage\n    });\n  }\n}\n","// @flow\n\nimport {performance, isPerformanceObserverAvailable} from './performance';\nimport {noop, now, addEventListener, removeEventListener} from './util';\nimport {setTimeout, clearTimeout} from './timers';\nimport {doc, win} from './browser';\n\nconst ONE_DAY_IN_MILLIS = 1000 * 60 * 60 * 24;\n\nexport type ObserveResourcePerformanceResult = {\n  duration: number,\n  resource: ?PerformanceResourceTiming\n};\n\ntype ObserveResourcePerformanceResultCallback = ObserveResourcePerformanceResult => any;\n\ntype ObserveResourcePerformanceOptions = {\n  entryTypes: string[],\n  resourceMatcher:  PerformanceResourceTiming => boolean,\n  maxWaitForResourceMillis: number,\n  onEnd: ObserveResourcePerformanceResultCallback\n};\n\n// Implements the capability to observe the performance data for a single entry on the performance timeline.\n// This is especially useful to make a connection between our beacon data and the performance timeline data.\n// Also see https://w3c.github.io/performance-timeline/#dom-performanceentrylist\nexport function observeResourcePerformance(opts: ObserveResourcePerformanceOptions) {\n  if (!isPerformanceObserverAvailable) {\n    return observeWithoutPerformanceObserverSupport(opts.onEnd);\n  }\n\n  // Used to calculate the duration when no resource was found.\n  let startTime;\n  let endTime;\n\n  // The identified resource. To be used when calling opts.onEnd\n  let resource;\n\n  // global resources that will need to be disposed\n  let observer;\n  let fallbackNoResourceFoundTimerHandle;\n  let fallbackEndNeverCalledTimerHandle;\n\n  return {\n    onBeforeResourceRetrieval,\n    onAfterResourceRetrieved,\n    cancel: disposeGlobalResources\n  };\n\n  function onBeforeResourceRetrieval() {\n    startTime = performance.now();\n    try {\n      observer = new win['PerformanceObserver'](onResource);\n      observer['observe']({'entryTypes': opts.entryTypes});\n    } catch (e) {\n      // Some browsers may not support the passed entryTypes and decide to throw an error.\n      // This would then result in an error with a message like:\n      //\n      // entryTypes only contained unsupported types\n      //\n      // Swallow and ignore the error. Treat it like unavailable performance observer data.\n    }\n    fallbackEndNeverCalledTimerHandle = setTimeout(disposeGlobalResources, 1000 * 60 * 10);\n  }\n\n  function onAfterResourceRetrieved() {\n    endTime = performance.now();\n    cancelFallbackEndNeverCalledTimerHandle();\n\n    if (resource || !isWaitingAcceptable()) {\n      end();\n    } else {\n      addEventListener(doc, 'visibilitychange', onVisibilityChanged);\n      fallbackNoResourceFoundTimerHandle = setTimeout(end, opts.maxWaitForResourceMillis);\n    }\n  }\n\n  function end() {\n    disposeGlobalResources();\n\n    let duration;\n    if (resource && resource.duration != null &&\n        // In some old web browsers, e.g. Chrome 31, the value provided as the duration\n        // can be very wrong. We have seen cases where this value is measured in years.\n        // If this does seem be the case, then we will ignore the duration property and\n        // instead prefer our approximation.\n        resource.duration < ONE_DAY_IN_MILLIS) {\n      duration = Math.round(resource.duration);\n    } else {\n      duration = Math.round(endTime - startTime);\n    }\n    opts.onEnd({resource, duration});\n  }\n\n  function onResource(list) {\n    const entries = list.getEntries();\n    for (let i = 0; i < entries.length; i++) {\n      const entry = entries[i];\n      if (entry.startTime >= startTime\n          && (!endTime || endTime >= entry.responseEnd)\n          && opts.resourceMatcher(entry)) {\n        resource = entry;\n        disconnectResourceObserver();\n\n        if (endTime) {\n          // End as quickly as possible to ensure that the data is transmitted to the server.\n          end();\n        }\n\n        return;\n      }\n    }\n  }\n\n  function onVisibilityChanged() {\n    if (!isWaitingAcceptable()) {\n      end();\n    }\n  }\n\n  function disposeGlobalResources() {\n    disconnectResourceObserver();\n    cancelFallbackNoResourceFoundTimer();\n    cancelFallbackEndNeverCalledTimerHandle();\n    stopVisibilityObservation();\n  }\n\n  function disconnectResourceObserver() {\n    if (observer) {\n      try {\n        observer['disconnect']();\n      } catch (e) {\n        // Observer disconnect may throw when connect attempt wasn't successful. Ignore this.\n      }\n      observer = null;\n    }\n  }\n\n  function cancelFallbackNoResourceFoundTimer() {\n    if (fallbackNoResourceFoundTimerHandle) {\n      clearTimeout(fallbackNoResourceFoundTimerHandle);\n      fallbackNoResourceFoundTimerHandle = null;\n    }\n  }\n\n  function cancelFallbackEndNeverCalledTimerHandle() {\n    if (fallbackEndNeverCalledTimerHandle) {\n      clearTimeout(fallbackEndNeverCalledTimerHandle);\n      fallbackEndNeverCalledTimerHandle = null;\n    }\n  }\n\n  function stopVisibilityObservation() {\n    removeEventListener(doc, 'visibilitychange', onVisibilityChanged);\n  }\n}\n\n// This variant of the performance observer is only used when the performance-timeline features\n// are not supported. See isPerformanceObserverAvailable\nfunction observeWithoutPerformanceObserverSupport(onEnd: ObserveResourcePerformanceResultCallback) {\n  let start;\n\n  return {\n    onBeforeResourceRetrieval,\n    onAfterResourceRetrieved,\n    cancel: noop\n  };\n\n  function onBeforeResourceRetrieval() {\n    start = now();\n  }\n\n  function onAfterResourceRetrieved() {\n    let end = now();\n    onEnd({duration: end - start});\n  }\n}\n\n// We may only wait for resource data to arrive as long as the document is visible or in the process\n// of becoming visible. In all other cases we might lose data when waiting, e.g. when the document\n// is in the process of being disposed.\nfunction isWaitingAcceptable() {\n  return doc.visibilityState === 'visible' || doc.visibilityState === 'prerender';\n}\n","// @flow\n\nimport {matchesAny} from './util';\nimport vars from './vars';\n\nexport function isAllowedOrigin(url: string) {\n  return matchesAny(vars.allowedOrigins, url);\n}\n","// @flow\n\nimport {debug} from '../debug';\n\nconst maximumHttpRequestUrlLength = 4096;\n\n// Asynchronously created a tag.\nlet urlAnalysisElement = null;\n\ntry {\n  urlAnalysisElement = document.createElement('a');\n} catch (e) {\n  if (DEBUG) {\n    debug('Failed to create URL analysis element. Will not be able to normalize URLs.', e);\n  }\n}\n\nexport function normalizeUrl(url: string): string {\n  if (urlAnalysisElement) {\n    try {\n      // \"a\"-elements normalize the URL when setting a relative URL or URLs\n      // that are missing a scheme\n      urlAnalysisElement.href = url;\n      url = urlAnalysisElement.href;\n    } catch (e) {\n      if (DEBUG) {\n        debug('Failed to normalize URL' + url);\n      }\n    }\n  }\n\n  // Hashes are never transmitted to the server and they are also not included in resource\n  // timings. Do not include them in the normalized URL.\n  const hashIndex = url.indexOf('#');\n  if (hashIndex >= 0) {\n    url = url.substring(0, hashIndex);\n  }\n\n  if (url.length > maximumHttpRequestUrlLength) {\n    url = url.substring(0, maximumHttpRequestUrlLength);\n  }\n\n  return url;\n}\n","// @flow\n\nimport { debug } from './debug';\nimport { win } from './browser';\n\n// Asynchronously created a tag.\n// document.createElement('a')\nlet urlAnalysisElement = null;\nlet documentOriginAnalysisElement = null;\ntry {\n  urlAnalysisElement = document.createElement('a');\n  documentOriginAnalysisElement = document.createElement('a');\n  documentOriginAnalysisElement.href = win.location.href;\n} catch (e) {\n  if (DEBUG) {\n    debug(\n      'Failed to create URL analysis elements. Will not be able to execute same-origin check, i.e. all same-origin checks will fail.',\n      e\n    );\n  }\n}\n\nexport function isSameOrigin(url: string): boolean {\n  if (!urlAnalysisElement || !documentOriginAnalysisElement) {\n    return false;\n  }\n\n  try {\n    urlAnalysisElement.href = url;\n\n    return (\n      // Most browsers support this fallback logic out of the box. Not so the Internet explorer.\n      // To make it work in Internet explorer, we need to add the fallback manually.\n      // IE 9 uses a colon as the protocol when no protocol is defined\n      (urlAnalysisElement.protocol && urlAnalysisElement.protocol !== ':'\n        ? urlAnalysisElement.protocol\n        : documentOriginAnalysisElement.protocol) === documentOriginAnalysisElement.protocol &&\n      (urlAnalysisElement.hostname || documentOriginAnalysisElement.hostname) === documentOriginAnalysisElement.hostname &&\n      (urlAnalysisElement.port || documentOriginAnalysisElement.port) === documentOriginAnalysisElement.port\n    );\n  } catch (e) {\n    return false;\n  }\n}\n","// @flow\n\nimport {createExcessiveUsageIdentifier} from '../excessiveUsageIdentification';\nimport type {ObserveResourcePerformanceResult} from '../performanceObserver';\nimport {addResourceTiming, addCorrelationHttpHeaders} from './xhrHelpers';\nimport {addCommonBeaconProperties} from '../commonBeaconProperties';\nimport {observeResourcePerformance} from '../performanceObserver';\nimport {isAllowedOrigin} from '../allowedOrigins';\nimport {sendBeacon} from '../transmission/index';\nimport {now, generateUniqueId} from '../util';\nimport {normalizeUrl} from './normalizeUrl';\nimport {isUrlIgnored} from '../ignoreRules';\nimport {debug, info, warn} from '../debug';\nimport {XMLHttpRequest} from '../browser';\nimport type {XhrBeacon} from '../types';\nimport {isSameOrigin} from '../sop';\nimport vars from '../vars';\n\nconst isExcessiveUsage = createExcessiveUsageIdentifier({\n  maxCallsPerTenMinutes: 256,\n  maxCallsPerTenSeconds: 32\n});\n\n// In addition to the common HTTP status codes, a bunch of\n// additional outcomes are possible. Mainly errors, the following\n// status codes denote internal codes which are used for beacons\n// to describe the XHR result.\nconst additionalStatuses = {\n  // https://xhr.spec.whatwg.org/#the-timeout-attribute\n  timeout: -100,\n\n  // Used when the request is aborted:\n  // https://xhr.spec.whatwg.org/#the-abort()-method\n  abort: -101,\n\n  // Errors may occur when opening an XHR object for a variety of\n  // reasons.\n  // https://xhr.spec.whatwg.org/#the-open()-method\n  openError: -102,\n\n  // Non-HTTP errors, e.g. failed to establish connection.\n  // https://xhr.spec.whatwg.org/#events\n  error: -103\n};\n\nconst traceIdHeaderRegEx = /^X-INSTANA-T$/i;\n\nexport function instrumentXMLHttpRequest() {\n  if (!XMLHttpRequest ||\n      !(new XMLHttpRequest()).addEventListener) {\n    if (DEBUG) {\n      info('Browser does not support the features required for XHR instrumentation.');\n    }\n    return;\n  }\n\n  const originalOpen = XMLHttpRequest.prototype.open;\n  const originalSetRequestHeader = XMLHttpRequest.prototype.setRequestHeader;\n  const originalSend = XMLHttpRequest.prototype.send;\n\n  if (!originalOpen || !originalSetRequestHeader || !originalSend) {\n    if (DEBUG) {\n      warn('The XMLHttpRequest prototype is in an unsupported state due to some missing XMLHttpRequest.prototype ' +\n        'properties. This is most likely caused by third-party libraries that are instrumenting/changing the ' +\n        'XMLHttpRequest API in a specification incompliant way.');\n    }\n    return;\n  }\n\n  XMLHttpRequest.prototype.open = function open(method, url, async) {\n    const xhr = this;\n\n    if (isExcessiveUsage()) {\n      if (DEBUG) {\n        info('Reached the maximum number of XMLHttpRequests to monitor.');\n      }\n\n      return originalOpen.apply(xhr, arguments);\n    }\n\n    const state = xhr[vars.secretPropertyKey] = xhr[vars.secretPropertyKey] || {};\n    // probably ignored due to disableMonitoringForXMLHttpRequest calls\n    if (state.ignored) {\n      return originalOpen.apply(xhr, arguments);\n    }\n\n    state.ignored = isUrlIgnored(url);\n    if (state.ignored) {\n      if (DEBUG) {\n        debug(\n          'Not generating XHR beacon because it should be ignored according to user configuration. URL: ' + url\n        );\n      }\n      return originalOpen.apply(xhr, arguments);\n    }\n\n    state.spanAndTraceId = generateUniqueId();\n    state.setBackendCorrelationHeaders = isSameOrigin(url) || isAllowedOrigin(url);\n\n    // $FlowFixMe: Some properties deliberately left our for js file size reasons.\n    const beacon: XhrBeacon = {\n      'ty': 'xhr',\n\n      // general beacon data\n      't': state.spanAndTraceId,\n      's': state.spanAndTraceId,\n      'ts': 0,\n      'd': 0,\n\n      // xhr beacon specific data\n      // 's': '',\n      'm': method,\n      'u': normalizeUrl(url),\n      'a': async === undefined || async ? 1 : 0,\n      'st': 0,\n      'e': undefined,\n      'bc': state.setBackendCorrelationHeaders ? 1 : 0\n    };\n    state.beacon = beacon;\n\n    state.performanceObserver = observeResourcePerformance({\n      entryTypes: ['resource'],\n      resourceMatcher: function resourceMatcher(resource:  PerformanceResourceTiming): boolean {\n        return (resource.initiatorType === 'fetch' || resource.initiatorType === 'xmlhttprequest') &&\n          // $FlowFixMe We know that beacon['u'] is now set\n          !!resource.name && resource.name.indexOf(beacon['u']) === 0;\n      },\n      maxWaitForResourceMillis: vars.maxWaitForResourceTimingsMillis,\n      onEnd: function onEnd(args: ObserveResourcePerformanceResult) {\n        beacon['d'] = args.duration;\n        if (args.resource) {\n          addResourceTiming(beacon, args.resource);\n        }\n        sendBeacon(beacon);\n      }\n    });\n\n    try {\n      const result = originalOpen.apply(xhr, arguments);\n      xhr.addEventListener('timeout', onTimeout);\n      xhr.addEventListener('error', onError);\n      xhr.addEventListener('abort', onAbort);\n      xhr.addEventListener('readystatechange', onReadystatechange);\n      return result;\n    } catch (e) {\n      state.performanceObserver.cancel();\n      beacon['ts'] = now() - vars.referenceTimestamp;\n      beacon['st'] = additionalStatuses.openError;\n      beacon['e'] = e.message;\n      addCommonBeaconProperties(beacon);\n      sendBeacon(beacon);\n      xhr[vars.secretPropertyKey] = null;\n      throw e;\n    }\n\n    function onFinish(status) {\n      if (state.ignored) {\n        return;\n      }\n\n      if (beacon['st'] !== 0) {\n        // Multiple finish events. Should only happen when we setup the event handlers\n        // in a wrong way or when the XHR object is reused. We don't support this use\n        // case.\n        return;\n      }\n\n      beacon['st'] = status;\n      // When accessing object properties as object['property'] instead of\n      // object.property flow does not know the type and assumes string.\n      // Arithmetic operations like addition are only allowed on numbers. OTOH,\n      // we can not safely use beacon.property as the compilation/minification\n      // step will rename the properties which results in JSON payloads with\n      // wrong property keys.\n      // $FlowFixMe: see above\n      beacon['d'] = Math.max(0, now() - (beacon['ts'] + vars.referenceTimestamp));\n\n      if (state.performanceObserver && status > 0) {\n        state.performanceObserver.onAfterResourceRetrieved();\n      } else {\n        if (state.performanceObserver) {\n          state.performanceObserver.cancel();\n        }\n        sendBeacon(beacon);\n      }\n    }\n\n    function onTimeout() {\n      onFinish(additionalStatuses.timeout);\n    }\n\n    function onError(e) {\n      if (state.ignored) {\n        return;\n      }\n\n      let message = e && ((e.error && e.error.message) || e.message);\n      if (typeof message === 'string') {\n        beacon['e'] = message.substring(0, 300);\n      }\n      onFinish(additionalStatuses.error);\n    }\n\n    function onAbort() {\n      onFinish(additionalStatuses.abort);\n    }\n\n    function onReadystatechange() {\n      if (xhr.readyState === 4) {\n        let status;\n\n        try {\n          status = xhr.status;\n        } catch (e) {\n          // IE 9 will throw errors when trying to access the status property\n          // on aborted requests and timeouts. We can swallow the error\n          // since we have separate event listeners for these types of\n          // situations.\n          onFinish(additionalStatuses.error);\n          return;\n        }\n\n        if (status !== 0) {\n          onFinish(status);\n        }\n      }\n    }\n  };\n\n  XMLHttpRequest.prototype.setRequestHeader = function setRequestHeader(header) {\n    const state = this[vars.secretPropertyKey];\n\n    // If this request was initiated by a fetch polyfill, the Instana headers\n    // will be set before xhr.send is called (by the fetch polyfill,\n    // translating the headers from the request definition object into\n    // XHR.setRequestHeader calls). We need to keep track of this so we can\n    // set this XHR to ignored in xhr.send.\n    if (state && traceIdHeaderRegEx.test(header)) {\n      if (DEBUG) {\n        debug(\n          'Not generating XHR beacon because correlation header is already set (possibly fetch polyfill applied).'\n        );\n      }\n      state.ignored = true;\n      if (state.performanceObserver) {\n        state.performanceObserver.cancel();\n        state.performanceObserver = null;\n      }\n    }\n    return originalSetRequestHeader.apply(this, arguments);\n  };\n\n  XMLHttpRequest.prototype.send = function send() {\n    const state = this[vars.secretPropertyKey];\n    if (!state || state.ignored) {\n      return originalSend.apply(this, arguments);\n    }\n\n    if (state.setBackendCorrelationHeaders) {\n      addCorrelationHttpHeaders(originalSetRequestHeader, this, state.spanAndTraceId);\n    }\n\n    state.beacon['ts'] = now() - vars.referenceTimestamp;\n    addCommonBeaconProperties(state.beacon);\n    state.performanceObserver.onBeforeResourceRetrieval();\n    return originalSend.apply(this, arguments);\n  };\n}\n","// @flow\n\nimport {performance, isResourceTimingAvailable} from './performance';\nimport {info} from './debug';\nimport vars from './vars';\n\nexport function getPageLoadBackendTraceId() {\n  if (!isResourceTimingAvailable) {\n    return null;\n  }\n\n  const entries = performance.getEntriesByType('navigation');\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i];\n\n    if (entry['serverTiming'] != null) {\n      for (let j = 0; j < entry['serverTiming'].length; j++) {\n        const serverTiming = entry['serverTiming'][j];\n        if (serverTiming['name'] === vars.serverTimingBackendTraceIdEntryName) {\n          if (DEBUG) {\n            info('Found page load backend trace ID %s in Server-Timing header.', serverTiming['description']);\n          }\n          return serverTiming['description'];\n        }\n      }\n    }\n  }\n\n  return null;\n}\n","// @flow\n\nimport vars from './vars';\n\n// Copied from flow's DOM type definition at:\n// https://github.com/facebook/flow/blob/master/lib/dom.js\nexport type EventListenerOptionsOrUseCapture =\n  | boolean\n  | {\n      capture?: boolean\n    };\n\n// Asynchronous function wrapping: The process of wrapping a listener which goes into one function, e.g.\n//\n//  - EventTarget#addEventListener\n//  - EventEmitter#on\n//\n// and is removed via another function, e.g.\n//\n//  - EventTarget#removeEventListener\n//  - EventEmitter#off\n//\n// What is complicated about this, is that these methods identify registered listeners by function reference.\n// When we wrap a function, we naturally change the reference. We must therefore keep track of which\n// original function belongs to what wrapped function.\n//\n// This file provides helpers that help in the typical cases. It is removed from all browser specific APIs\n// in order to allow simple unit test execution.\n//\n// Note that this file follows the behavior outlined in DOM specification. Among others, this means that it is not\n// possible to register the same listener twice.\n// http://dom.spec.whatwg.org\n\nexport function addWrappedFunction(\n  storageTarget: Object,\n  wrappedFunction: Function,\n  valuesForEqualityCheck: any[]\n): Function {\n  const storage = (storageTarget[vars.wrappedEventHandlersOriginalFunctionStorageKey] =\n    storageTarget[vars.wrappedEventHandlersOriginalFunctionStorageKey] || []);\n  const index = findInStorage(storageTarget, valuesForEqualityCheck);\n  if (index !== -1) {\n    // already registered. Do not allow re-registration\n    return storage[index].wrappedFunction;\n  }\n\n  storage.push({\n    wrappedFunction,\n    valuesForEqualityCheck\n  });\n  return wrappedFunction;\n}\n\nfunction findInStorage(storageTarget: Object, valuesForEqualityCheck: any[]): number {\n  const storage = storageTarget[vars.wrappedEventHandlersOriginalFunctionStorageKey];\n  for (let i = 0; i < storage.length; i++) {\n    const storageItem = storage[i];\n\n    if (matchesEqualityCheck(storageItem.valuesForEqualityCheck, valuesForEqualityCheck)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function popWrappedFunction(storageTarget: Object, valuesForEqualityCheck: any[], fallback: Function): Function {\n  const storage = storageTarget[vars.wrappedEventHandlersOriginalFunctionStorageKey];\n  if (storage == null) {\n    return fallback;\n  }\n\n  const index = findInStorage(storageTarget, valuesForEqualityCheck);\n  if (index === -1) {\n    return fallback;\n  }\n\n  const storageItem = storage[index];\n  storage.splice(index, 1);\n  return storageItem.wrappedFunction;\n}\n\nfunction matchesEqualityCheck(valuesForEqualityCheckA, valuesForEqualityCheckB) {\n  if (valuesForEqualityCheckA.length !== valuesForEqualityCheckB.length) {\n    return false;\n  }\n\n  for (let i = 0; i < valuesForEqualityCheckA.length; i++) {\n    if (valuesForEqualityCheckA[i] !== valuesForEqualityCheckB[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function addWrappedDomEventListener(\n  storageTarget: Object,\n  wrappedFunction: Function,\n  eventName: string,\n  eventListener: Function,\n  optionsOrCapture?: EventListenerOptionsOrUseCapture\n): Function {\n  return addWrappedFunction(\n    storageTarget,\n    wrappedFunction,\n    getDomEventListenerValuesForEqualityCheck(eventName, eventListener, optionsOrCapture)\n  );\n}\n\nfunction getDomEventListenerValuesForEqualityCheck(\n  eventName: string,\n  eventListener: Function,\n  optionsOrCapture?: EventListenerOptionsOrUseCapture\n): any[] {\n  return [eventName, eventListener, getDomEventListenerCaptureValue(optionsOrCapture)];\n}\n\nexport function getDomEventListenerCaptureValue(optionsOrCapture?: EventListenerOptionsOrUseCapture): boolean {\n  // > Let capture, passive, and once be the result of flattening more options.\n  // https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener\n  //\n  // > To flatten more options, run these steps:\n  // > 1. Let capture be the result of flattening options.\n  // https://dom.spec.whatwg.org/#event-flatten-more\n  //\n  // > To flatten options, run these steps:\n  // > 1. If options is a boolean, then return options.\n  // > 2. Return optionsâ€™s capture.\n  // https://dom.spec.whatwg.org/#concept-flatten-options\n  //\n  // > dictionary EventListenerOptions {\n  // >   boolean capture = false;\n  // > };\n  // https://dom.spec.whatwg.org/#dom-eventlisteneroptions-capture\n  if (optionsOrCapture == null) {\n    return false;\n  } else if (typeof optionsOrCapture === 'object') {\n    return Boolean(optionsOrCapture.capture);\n  }\n  return Boolean(optionsOrCapture);\n}\n\nexport function popWrappedDomEventListener(\n  storageTarget: Object,\n  eventName: string,\n  eventListener: Function,\n  optionsOrCapture?: EventListenerOptionsOrUseCapture,\n  fallback: Function\n): Function {\n  return popWrappedFunction(\n    storageTarget,\n    getDomEventListenerValuesForEqualityCheck(eventName, eventListener, optionsOrCapture),\n    fallback\n  );\n}\n","// @flow\n\nimport { addWrappedDomEventListener, popWrappedDomEventListener } from '../asyncFunctionWrapping';\nimport type { EventListenerOptionsOrUseCapture } from '../asyncFunctionWrapping';\nimport { reportError, ignoreNextOnErrorEvent } from './unhandledError';\nimport { win } from '../browser';\nimport vars from '../vars';\n\nexport function wrapEventHandlers() {\n  if (vars.wrapEventHandlers) {\n    wrapEventTarget(win.EventTarget);\n  }\n}\n\nfunction wrapEventTarget(EventTarget) {\n  if (\n    !EventTarget ||\n    typeof EventTarget.prototype.addEventListener !== 'function' ||\n    typeof EventTarget.prototype.removeEventListener !== 'function'\n  ) {\n    return;\n  }\n\n  const originalAddEventListener = EventTarget.prototype.addEventListener;\n  const originalRemoveEventListener = EventTarget.prototype.removeEventListener;\n\n  EventTarget.prototype.addEventListener = function wrappedAddEventListener(\n    eventName: string,\n    fn: Function,\n    optionsOrCapture?: EventListenerOptionsOrUseCapture\n  ) {\n    if (typeof fn !== 'function') {\n      return originalAddEventListener.apply(this, arguments);\n    }\n\n    // non-deopt arguments copy\n    const args = new Array(arguments.length);\n    for (let i = 0; i < arguments.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[1] = function wrappedEventListener() {\n      try {\n        return fn.apply(this, arguments);\n      } catch (e) {\n        reportError(e);\n        ignoreNextOnErrorEvent();\n        throw e;\n      }\n    };\n\n    args[1] = addWrappedDomEventListener(this, args[1], eventName, fn, optionsOrCapture);\n\n    return originalAddEventListener.apply(this, args);\n  };\n\n  EventTarget.prototype.removeEventListener = function wrappedRemoveEventListener(\n    eventName: string,\n    fn: Function,\n    optionsOrCapture?: EventListenerOptionsOrUseCapture\n  ) {\n    if (typeof fn !== 'function') {\n      return originalRemoveEventListener.apply(this, arguments);\n    }\n\n    // non-deopt arguments copy\n    const args = new Array(arguments.length);\n    for (let i = 0; i < arguments.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[1] = popWrappedDomEventListener(this, eventName, fn, optionsOrCapture, fn);\n\n    return originalRemoveEventListener.apply(this, args);\n  };\n}\n","// @flow\n\nimport {addCommonBeaconProperties, addMetaDataToBeacon} from './commonBeaconProperties';\nimport {createExcessiveUsageIdentifier} from './excessiveUsageIdentification';\nimport type {CustomEventBeacon, CustomEventOptions} from './types';\nimport {shortenStackTrace} from './hooks/unhandledError';\nimport {sendBeacon} from './transmission/index';\nimport {now, generateUniqueId} from './util';\nimport {getActiveTraceId} from './fsm';\nimport {info} from './debug';\n\nconst isExcessiveUsage = createExcessiveUsageIdentifier({\n  maxCallsPerTenMinutes: 128,\n  maxCallsPerTenSeconds: 32\n});\n\nexport function reportCustomEvent(eventName: string, opts: ?CustomEventOptions): void {\n  if (isExcessiveUsage()) {\n    if (DEBUG) {\n      info('Reached the maximum number of custom events to monitor');\n    }\n    return;\n  }\n\n  let traceId = getActiveTraceId();\n  const spanId = generateUniqueId();\n  if (!traceId) {\n    traceId = spanId;\n  }\n\n  // $FlowFixMe: Some properties deliberately left our for js file size reasons.\n  const beacon: CustomEventBeacon = {\n    'ty': 'cus',\n    's': spanId,\n    't': traceId,\n    'ts': now(),\n    'n': eventName\n  };\n\n  addCommonBeaconProperties(beacon);\n\n  if (opts) {\n    enrich(beacon, opts);\n  }\n\n  sendBeacon(beacon);\n}\n\nfunction enrich(beacon: CustomEventBeacon, opts: CustomEventOptions) {\n  if (opts['meta']) {\n    addMetaDataToBeacon(beacon, opts['meta']);\n  }\n\n  if (typeof opts['duration'] === 'number' && !isNaN(opts['duration'])) {\n    beacon['d'] = opts['duration'];\n    // $FlowFixMe: We know that both properties are numbers. Flow thinks they are strings because we access them via [â€¦].\n    beacon['ts'] = beacon['ts'] - opts['duration'];\n  }\n\n  if (typeof opts['timestamp'] === 'number' && !isNaN(opts['timestamp'])) {\n    beacon['ts'] = opts['timestamp'];\n  }\n\n  if (typeof opts['backendTraceId'] === 'string') {\n    beacon['bt'] = opts['backendTraceId'].substring(0, 64);\n  }\n\n  if (opts['error']) {\n    beacon['e'] = String(opts['error']['message']).substring(0, 300);\n    beacon['st'] = shortenStackTrace(opts['error']['stack']);\n  }\n\n  if (typeof opts['componentStack'] === 'string') {\n    beacon['cs'] = opts['componentStack'].substring(0, 4096);\n  }\n}\n","// @flow\n\nimport {performance, isResourceTimingAvailable, isPerformanceObserverAvailable} from '../performance';\nimport {pageLoadStartTimestamp} from '../timings';\nimport {reportCustomEvent} from '../customEvents';\nimport {matchesAny} from '../util';\nimport {win} from '../browser';\nimport {info} from '../debug';\nimport vars from '../vars';\n\nexport function hookIntoUserTimings() {\n  if (performance && performance['timeOrigin'] && isResourceTimingAvailable) {\n    drainExistingPerformanceEntries();\n    observeNewUserTimings();\n  }\n}\n\nfunction drainExistingPerformanceEntries() {\n  onUserTimings(performance.getEntriesByType('mark'));\n  onUserTimings(performance.getEntriesByType('measure'));\n}\n\nfunction onUserTimings(performanceEntries: PerformanceEntry[]) {\n  for (let i = 0; i < performanceEntries.length; i++) {\n    onUserTiming(performanceEntries[i]);\n  }\n}\n\nfunction onUserTiming(performanceEntry: PerformanceEntry) {\n  if (matchesAny(vars.ignoreUserTimings, performanceEntry.name)) {\n    if (DEBUG) {\n      info('Ignoring user timing \"%s\" because it is ignored via the configuration.', performanceEntry.name);\n    }\n    return;\n  }\n\n  let duration;\n  if (performanceEntry.entryType !== 'mark') {\n    duration = Math.round(performanceEntry.duration);\n  }\n\n  // $FlowFixMe: Flow cannot detect that this is a proper usage of the function. We have to write it this way because of the Closure compiler advanced mode.\n  reportCustomEvent(performanceEntry.name, {\n    // Do not allow the timestamp to be before our Notion of page load start.\n    'timestamp': Math.max(\n      pageLoadStartTimestamp,\n      Math.round(performance['timeOrigin'] + performanceEntry.startTime)\n    ),\n    'duration': duration,\n    'meta': {\n      'userTimingType': performanceEntry.entryType\n    }\n  });\n}\n\nfunction observeNewUserTimings() {\n  if (isPerformanceObserverAvailable) {\n    try {\n      const observer = new win['PerformanceObserver'](onObservedPerformanceEntries);\n      observer['observe']({'entryTypes': ['mark', 'measure']});\n    } catch (e) {\n      // Some browsers may not support the passed entryTypes and decide to throw an error.\n      // This would then result in an error with a message like:\n      //\n      // entryTypes only contained unsupported types\n      //\n      // Swallow and ignore the error. Treat it like unavailable performance observer data.\n    }\n  }\n}\n\nfunction onObservedPerformanceEntries(list) {\n  onUserTimings(list.getEntries());\n}\n","// @flow\n\nimport {createExcessiveUsageIdentifier} from '../excessiveUsageIdentification';\nimport type {ObserveResourcePerformanceResult} from '../performanceObserver';\nimport {addResourceTiming, addCorrelationHttpHeaders} from './xhrHelpers';\nimport {addCommonBeaconProperties} from '../commonBeaconProperties';\nimport {observeResourcePerformance} from '../performanceObserver';\nimport {now, generateUniqueId, matchesAny} from '../util';\nimport {isAllowedOrigin} from '../allowedOrigins';\nimport {sendBeacon} from '../transmission/index';\nimport {originalFetch, win} from '../browser';\nimport {normalizeUrl} from './normalizeUrl';\nimport {isUrlIgnored} from '../ignoreRules';\nimport type {XhrBeacon} from '../types';\nimport {debug, info} from '../debug';\nimport {isSameOrigin} from '../sop';\nimport vars from '../vars';\n\nconst isExcessiveUsage = createExcessiveUsageIdentifier({\n  maxCallsPerTenMinutes: 256,\n  maxCallsPerTenSeconds: 32\n});\n\nexport function instrumentFetch() {\n  if (!win.fetch || !win.Request) {\n    if (DEBUG) {\n      info('Browser does not support the Fetch API.');\n    }\n    return;\n  }\n\n  win.fetch = function(input, init) {\n    const request = new Request(input, init);\n\n    if (isExcessiveUsage()) {\n      if (DEBUG) {\n        info('Reached the maximum number of fetch calls to monitor.');\n      }\n      return originalFetch(request);\n    }\n\n    const url = request.url;\n\n    if (isUrlIgnored(url)) {\n      if (DEBUG) {\n        debug(\n          'Not generating XHR beacon for fetch call because it is to be ignored according to user configuration. URL: ' + url\n        );\n      }\n      return originalFetch(request);\n    }\n\n    // $FlowFixMe: Some properties deliberately left our for js file size reasons.\n    const beacon: XhrBeacon = {\n      'ty': 'xhr',\n\n      // 't': '',\n      'ts': now() - vars.referenceTimestamp,\n      'd': 0,\n\n      // xhr beacon specific data\n      // 's': '',\n      'm': '',\n      'u': '',\n      'a': 1,\n      'st': 0,\n      'e': undefined\n    };\n\n    addCommonBeaconProperties(beacon);\n    addGraphQlProperties(beacon, input, init);\n\n    const spanAndTraceId = generateUniqueId();\n    const setBackendCorrelationHeaders = isSameOrigin(url) || isAllowedOrigin(url);\n\n    beacon['t'] = spanAndTraceId;\n    beacon['s'] = spanAndTraceId;\n    beacon['m'] = request.method;\n    beacon['u'] = normalizeUrl(url);\n    beacon['a'] = 1;\n    beacon['bc'] = setBackendCorrelationHeaders ? 1 : 0;\n\n    if (setBackendCorrelationHeaders) {\n      addCorrelationHttpHeaders(request.headers.append, request.headers, spanAndTraceId);\n    }\n\n    const performanceObserver = observeResourcePerformance({\n      entryTypes: ['resource'],\n      resourceMatcher,\n      maxWaitForResourceMillis: vars.maxWaitForResourceTimingsMillis,\n      onEnd\n    });\n    performanceObserver.onBeforeResourceRetrieval();\n\n    return originalFetch(request)\n      .then(function(response) {\n        beacon['st'] = response.status;\n        // When accessing object properties as object['property'] instead of\n        // object.property flow does not know the type and assumes string.\n        // Arithmetic operations like addition are only allowed on numbers. OTOH,\n        // we can not safely use beacon.property as the compilation/minification\n        // step will rename the properties which results in JSON payloads with\n        // wrong property keys.\n        // $FlowFixMe: see above\n        performanceObserver.onAfterResourceRetrieved();\n        return response;\n      }, function(e) {\n        performanceObserver.cancel();\n        // $FlowFixMe: see above\n        beacon['d'] = now() - (beacon['ts'] + vars.referenceTimestamp);\n        beacon['e'] = e.message;\n        beacon['st'] = -103;\n        sendBeacon(beacon);\n        throw e;\n      });\n\n    function resourceMatcher(resource:  PerformanceResourceTiming): boolean {\n      return (resource.initiatorType === 'fetch' || resource.initiatorType === 'xmlhttprequest') &&\n        // $FlowFixMe We know that beacon['u'] is now set\n        Boolean(resource.name) && resource.name.indexOf(beacon['u']) === 0;\n    }\n\n    function onEnd(args: ObserveResourcePerformanceResult) {\n      beacon['d'] = args.duration;\n      if (args.resource) {\n        addResourceTiming(beacon, args.resource);\n      }\n      sendBeacon(beacon);\n    }\n  };\n}\n\nconst queryIdentification = /^\\s*query(\\s|\\{)/i;\nconst mutationIdentification = /^\\s*mutation(\\s|\\{)/i;\n\nfunction addGraphQlProperties(beacon: XhrBeacon, input, init) {\n  try {\n    if (typeof input !== 'string' ||\n        !init ||\n        init.method !== 'POST' ||\n        typeof init.body !== 'string' ||\n        !matchesAny(vars.urlsToCheckForGraphQlInsights, input)) {\n      return;\n    }\n\n    const body = JSON.parse(init.body);\n\n    if (typeof body['operationName'] === 'string') {\n      beacon['gon'] = body['operationName'];\n    }\n\n    if (typeof body['query'] === 'string') {\n      if (queryIdentification.test(body['query'])) {\n        beacon['got'] = 'query';\n      } else if (mutationIdentification.test(body['query'])) {\n        beacon['got'] = 'mutation';\n      } else if (body['query'].indexOf('{') === 0 && body['operationName'] === null) {\n        beacon['got'] = 'query';\n      }\n    }\n  } catch (e) {\n    if (DEBUG) {\n      debug('Failed to analyze request for GraphQL insights.', input, init);\n    }\n  }\n\n}\n","// @flow\n\n// localStorage API re-exposed to allow testing.\n\nimport { localStorage } from './browser';\n\nexport const isSupported =\n  localStorage != null && typeof localStorage.getItem === 'function' && typeof localStorage.setItem === 'function';\n\nexport function getItem(k: string): ?string {\n  if (isSupported && localStorage) {\n    return localStorage.getItem(k);\n  }\n}\n\nexport function setItem(k: string, v: string): void {\n  if (isSupported && localStorage) {\n    localStorage.setItem(k, v);\n  }\n}\n\nexport function removeItem(k: string): void {\n  if (isSupported && localStorage) {\n    localStorage.removeItem(k);\n  }\n}\n","// @flow\n\nimport {isSupported, getItem, setItem, removeItem} from './localStorage';\nimport {generateUniqueId, now} from './util';\nimport {info, warn} from './debug';\nimport vars from './vars';\n\ninterface Session {\n  id: string,\n  startTime: number,\n  lastActivityTime: number\n}\n\nconst storageSeparatorKey = '#';\n\nexport function trackSessions(sessionInactivityTimeoutMillis: ?number,\n  sessionTerminationTimeoutMillis: ?number): void {\n\n  if (!isSupported) {\n    if (DEBUG) {\n      info('Storage API is not available and session tracking is therefore not supported.');\n    }\n    return;\n  }\n\n  if (!sessionInactivityTimeoutMillis) {\n    sessionInactivityTimeoutMillis = vars.defaultSessionInactivityTimeoutMillis;\n  }\n  if (!sessionTerminationTimeoutMillis) {\n    sessionTerminationTimeoutMillis = vars.defaultSessionTerminationTimeoutMillis;\n  }\n  sessionInactivityTimeoutMillis = Math.min(sessionInactivityTimeoutMillis, vars.maxAllowedSessionTimeoutMillis);\n  sessionTerminationTimeoutMillis = Math.min(sessionTerminationTimeoutMillis, vars.maxAllowedSessionTimeoutMillis);\n\n  try {\n    let storedValue: ?string = getItem(vars.sessionStorageKey);\n\n    let session: ?Session = parseSession(storedValue);\n    if (session && !isSessionValid(session, sessionInactivityTimeoutMillis, sessionTerminationTimeoutMillis)) {\n      session = null;\n    }\n\n    if (session) {\n      session.lastActivityTime = now();\n    } else {\n      session = {\n        id: generateUniqueId(),\n        startTime: now(),\n        lastActivityTime: now()\n      };\n    }\n\n    setItem(vars.sessionStorageKey, serializeSession(session));\n    vars.sessionId = session.id;\n  } catch (e) {\n    if (DEBUG) {\n      warn('Failed to record session information', e);\n    }\n  }\n}\n\nexport function terminateSession() {\n  vars.sessionId = undefined;\n\n  if (!isSupported) {\n    return;\n  }\n\n  try {\n    removeItem(vars.sessionStorageKey);\n  } catch (e) {\n    if (DEBUG) {\n      info('Failed to terminate session', e);\n    }\n  }\n}\n\nfunction parseSession(storedValue: ?string): ?Session {\n  if (!storedValue) {\n    return null;\n  }\n\n  const values = storedValue.split(storageSeparatorKey);\n  if (values.length < 3) {\n    return null;\n  }\n\n  const id = values[0];\n  const startTime = parseInt(values[1], 10);\n  const lastActivityTime = parseInt(values[2], 10);\n  if (!id || isNaN(startTime) || isNaN(lastActivityTime)) {\n    return null;\n  }\n\n  return {\n    id,\n    startTime,\n    lastActivityTime\n  };\n}\n\nfunction serializeSession(session: Session): string {\n  return session.id + storageSeparatorKey + session.startTime + storageSeparatorKey + session.lastActivityTime;\n}\n\nfunction isSessionValid(session: Session,\n  sessionInactivityTimeoutMillis: number,\n  sessionTerminationTimeoutMillis: number): boolean {\n\n  const minAllowedLastActivityTime = now() - sessionInactivityTimeoutMillis;\n  if (session.lastActivityTime < minAllowedLastActivityTime) {\n    return false;\n  }\n\n  const minAllowedStartTime = now() - sessionTerminationTimeoutMillis;\n  if (session.startTime < minAllowedStartTime) {\n    return false;\n  }\n\n  return true;\n}\n","// @flow\n\nimport {createExcessiveUsageIdentifier} from './excessiveUsageIdentification';\nimport {addCommonBeaconProperties} from './commonBeaconProperties';\nimport {pageLoad as pageLoadPhase} from './phases';\nimport {sendBeacon} from './transmission/index';\nimport type {PageChangeBeacon} from './types';\nimport {getActivePhase} from './fsm';\nimport {info} from './debug';\nimport {now} from './util';\nimport vars from './vars';\n\nconst isExcessiveUsage = createExcessiveUsageIdentifier({\n  maxCallsPerTenMinutes: 128,\n  maxCallsPerTenSeconds: 32\n});\n\nexport function setPage(page: ?string): void {\n  const previousPage = vars.page;\n  vars.page = page;\n\n  const isInitialPageDefinition = getActivePhase() === pageLoadPhase && previousPage == null;\n  if (!isInitialPageDefinition && previousPage !== page) {\n    if (isExcessiveUsage()) {\n      if (DEBUG) {\n        info('Reached the maximum number of page changes to monitor.');\n      }\n    } else {\n      reportPageChange();\n    }\n  }\n}\n\nfunction reportPageChange(): void {\n  // $FlowFixMe: Some properties deliberately left our for js file size reasons.\n  const beacon: PageChangeBeacon = {\n    'ty': 'pc',\n    'ts': now()\n  };\n  addCommonBeaconProperties(beacon);\n  sendBeacon(beacon);\n}\n","// @flow\n\nimport {trackSessions, terminateSession} from './session';\nimport {reportError} from './hooks/unhandledError';\nimport {reportCustomEvent} from './customEvents';\nimport {setPage} from './pageChange';\nimport {warn} from './debug';\nimport vars from './vars';\n\nexport function processCommand(command: any[]): any {\n  switch (command[0]) {\n  case 'apiKey':\n    vars.apiKey = command[1];\n    break;\n  case 'key':\n    vars.apiKey = command[1];\n    break;\n  case 'reportingUrl':\n    vars.reportingUrl = command[1];\n    break;\n  case 'meta':\n    vars.meta[command[1]] = command[2];\n    break;\n  case 'traceId':\n    vars.pageLoadBackendTraceId = command[1];\n    break;\n  case 'ignoreUrls':\n    if (DEBUG) {\n      validateRegExpArray('ignoreUrls', command[1]);\n    }\n    vars.ignoreUrls = command[1];\n    break;\n  case 'ignoreErrorMessages':\n    if (DEBUG) {\n      validateRegExpArray('ignoreErrorMessages', command[1]);\n    }\n    vars.ignoreErrorMessages = command[1];\n    break;\n  case 'allowedOrigins':\n  case 'whitelistedOrigins': // a deprecated alias for allowedOrigins\n    if (DEBUG) {\n      validateRegExpArray('allowedOrigins', command[1]);\n    }\n    vars.allowedOrigins = command[1];\n    break;\n  case 'ignoreUserTimings':\n    if (DEBUG) {\n      validateRegExpArray('ignoreUserTimings', command[1]);\n    }\n    vars.ignoreUserTimings = command[1];\n    break;\n  case 'xhrTransmissionTimeout':\n    vars.xhrTransmissionTimeout = command[1];\n    break;\n  case 'page':\n    setPage(command[1]);\n    break;\n  case 'ignorePings':\n    vars.ignorePings = command[1];\n    break;\n  case 'reportError':\n    reportError(command[1], command[2]);\n    break;\n  case 'wrapEventHandlers':\n    vars.wrapEventHandlers = command[1];\n    break;\n  case 'wrapTimers':\n    vars.wrapTimers = command[1];\n    break;\n  case 'getPageLoadId':\n    return vars.pageLoadTraceId;\n  case 'user':\n    if (command[1]) {\n      vars.userId = String(command[1]).substring(0, 128);\n    }\n    if (command[2]) {\n      vars.userName = String(command[2]).substring(0, 128);\n    }\n    if (command[3]) {\n      vars.userEmail = String(command[3]).substring(0, 128);\n    }\n    break;\n  case 'reportEvent':\n    reportCustomEvent(command[1], command[2]);\n    break;\n  case 'beaconBatchingTime':\n    vars.beaconBatchingTime = command[1];\n    break;\n  case 'maxWaitForResourceTimingsMillis':\n    vars.maxWaitForResourceTimingsMillis = command[1];\n    break;\n  case 'maxMaitForPageLoadMetricsMillis':\n    vars.maxMaitForPageLoadMetricsMillis = command[1];\n    break;\n  case 'trackSessions':\n    trackSessions(command[1], command[2]);\n    break;\n  case 'terminateSession':\n    terminateSession();\n    break;\n  case 'urlsToCheckForGraphQlInsights':\n    if (DEBUG) {\n      validateRegExpArray('urlsToCheckForGraphQlInsights', command[1]);\n    }\n    vars.urlsToCheckForGraphQlInsights = command[1];\n    break;\n  default:\n    if (DEBUG) {\n      warn('Unsupported command: ' + command[0]);\n    }\n    break;\n  }\n}\n\nfunction validateRegExpArray(name, arr) {\n  if (!(arr instanceof Array)) {\n    return warn(name + ' is not an array. This will result in errors.');\n  }\n\n  for (let i = 0, len = arr.length; i < len; i++) {\n    if (!(arr[i] instanceof RegExp)) {\n      return warn(name + '[' + i + '] is not a RegExp. This will result in errors.');\n    }\n  }\n}\n","// @flow\n\nimport {reportError, ignoreNextOnErrorEvent} from './unhandledError';\nimport {isRunningZoneJs} from '../timers';\nimport {win} from '../browser';\nimport {warn} from '../debug';\nimport vars from '../vars';\n\nexport function wrapTimers() {\n  if (vars.wrapTimers) {\n    if (isRunningZoneJs) {\n      if (DEBUG) {\n        warn('We discovered a usage of Zone.js. In order to avoid any incompatibility issues timer wrapping is not going to be enabled.');\n      }\n      return;\n    }\n    wrapTimer('setTimeout');\n    wrapTimer('setInterval');\n  }\n}\n\nfunction wrapTimer(name) {\n  const original = win[name];\n  if (typeof original !== 'function') {\n    // cannot wrap because fn is not a function â€“ should actually never happen\n    return;\n  }\n\n  win[name] = function wrappedTimerSetter(fn) {\n    // non-deopt arguments copy\n    const args = new Array(arguments.length);\n    for (let i = 0; i < arguments.length; i++) {\n      args[i] = arguments[i];\n    }\n    args[0] = wrap(fn);\n    return original.apply(this, args);\n  };\n}\n\nfunction wrap(fn) {\n  if (typeof fn !== 'function') {\n    // cannot wrap because fn is not a function\n    return fn;\n  }\n\n  return function wrappedTimerHandler() {\n    try {\n      return fn.apply(this, arguments);\n    } catch (e) {\n      reportError(e);\n      ignoreNextOnErrorEvent();\n      throw e;\n    }\n  };\n}\n","var t,n,e=function(){return\"\".concat(Date.now(),\"-\").concat(Math.floor(8999999999999*Math.random())+1e12)},i=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return{name:t,value:n,delta:0,entries:[],id:e(),isFinal:!1}},a=function(t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var e=new PerformanceObserver((function(t){return t.getEntries().map(n)}));return e.observe({type:t,buffered:!0}),e}}catch(t){}},r=!1,o=!1,s=function(t){r=!t.persisted},u=function(){addEventListener(\"pagehide\",s),addEventListener(\"unload\",(function(){}))},c=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o||(u(),o=!0),addEventListener(\"visibilitychange\",(function(n){var e=n.timeStamp;\"hidden\"===document.visibilityState&&t({timeStamp:e,isUnloading:r})}),{capture:!0,once:n})},l=function(t,n,e,i){var a;return function(){e&&n.isFinal&&e.disconnect(),n.value>=0&&(i||n.isFinal||\"hidden\"===document.visibilityState)&&(n.delta=n.value-(a||0),(n.delta||n.isFinal||void 0===a)&&(t(n),a=n.value))}},p=function(t){var n,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=i(\"CLS\",0),o=function(t){t.hadRecentInput||(r.value+=t.value,r.entries.push(t),n())},s=a(\"layout-shift\",o);s&&(n=l(t,r,s,e),c((function(t){var e=t.isUnloading;s.takeRecords().map(o),e&&(r.isFinal=!0),n()})))},d=function(){return void 0===t&&(t=\"hidden\"===document.visibilityState?0:1/0,c((function(n){var e=n.timeStamp;return t=e}),!0)),{get timeStamp(){return t}}},v=function(t){var n,e=i(\"FCP\"),r=d(),o=a(\"paint\",(function(t){\"first-contentful-paint\"===t.name&&t.startTime<r.timeStamp&&(e.value=t.startTime,e.isFinal=!0,e.entries.push(t),n())}));o&&(n=l(t,e,o))},m=function(t){var n=i(\"FID\"),e=d(),r=function(t){t.startTime<e.timeStamp&&(n.value=t.processingStart-t.startTime,n.entries.push(t),n.isFinal=!0,s())},o=a(\"first-input\",r),s=l(t,n,o);o?c((function(){o.takeRecords().map(r),o.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(t,i){i.timeStamp<e.timeStamp&&(n.value=t,n.isFinal=!0,n.entries=[{entryType:\"first-input\",name:i.type,target:i.target,cancelable:i.cancelable,startTime:i.timeStamp,processingStart:i.timeStamp+t}],s())}))},f=function(){return n||(n=new Promise((function(t){return[\"scroll\",\"keydown\",\"pointerdown\"].map((function(n){addEventListener(n,t,{once:!0,passive:!0,capture:!0})}))}))),n},g=function(t){var n,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=i(\"LCP\"),o=d(),s=function(t){var e=t.startTime;e<o.timeStamp?(r.value=e,r.entries.push(t)):r.isFinal=!0,n()},u=a(\"largest-contentful-paint\",s);if(u){n=l(t,r,u,e);var p=function(){r.isFinal||(u.takeRecords().map(s),r.isFinal=!0,n())};f().then(p),c(p,!0)}},h=function(t){var n,e=i(\"TTFB\");n=function(){try{var n=performance.getEntriesByType(\"navigation\")[0]||function(){var t=performance.timing,n={entryType:\"navigation\",startTime:0};for(var e in t)\"navigationStart\"!==e&&\"toJSON\"!==e&&(n[e]=Math.max(t[e]-t.navigationStart,0));return n}();e.value=e.delta=n.responseStart,e.entries=[n],e.isFinal=!0,t(e)}catch(t){}},\"complete\"===document.readyState?setTimeout(n,0):addEventListener(\"pageshow\",n)};export{p as getCLS,v as getFCP,m as getFID,g as getLCP,h as getTTFB};\n","// @flow\n\n// $FlowFixMe Flow doesn't find the file. Let's ignore this for now.\nimport { getCLS, getLCP, getFID } from 'web-vitals/dist/web-vitals.es5.min.js';\nimport type {PageLoadBeacon} from './types';\n\ninterface Metric {\n  name: 'CLS' | 'FID' | 'LCP',\n\n  value: number\n}\n\nexport function addWebVitals(beacon: PageLoadBeacon) {\n  getLCP(onMetric, true);\n  getFID(onMetric, true);\n  getCLS(onMetricWithoutRounding, true);\n\n  function onMetric(metric: Metric) {\n    beacon['t_' + metric.name.toLocaleLowerCase()] = Math.round(metric.value);\n  }\n\n  function onMetricWithoutRounding(metric: Metric) {\n    beacon['t_' + metric.name.toLocaleLowerCase()] = metric.value;\n  }\n}\n\n\n","// @flow\n\nimport {hookIntoGlobalUnhandledRejectionEvent} from '../hooks/unhandledRejection';\nimport {instrumentXMLHttpRequest} from '../hooks/XMLHttpRequest';\nimport {hookIntoGlobalErrorEvent} from '../hooks/unhandledError';\nimport {getPageLoadBackendTraceId} from '../serverTiming';\nimport {wrapEventHandlers} from '../hooks/eventHandlers';\nimport {hookIntoUserTimings} from '../hooks/userTiming';\nimport {beacon as pageLoadBeacon} from './pageLoaded';\nimport {pageLoad as pageLoadPhase} from '../phases';\nimport {instrumentFetch} from '../hooks/Fetch';\nimport {processCommand} from '../commands';\nimport {wrapTimers} from '../hooks/timers';\nimport {error, warn, info} from '../debug';\nimport {addWebVitals} from '../webVitals';\nimport {transitionTo} from '../fsm';\nimport type {State} from '../types';\nimport {win} from '../browser';\nimport vars from '../vars';\n\nconst state: State = {\n  onEnter() {\n    if (DEBUG && !fulfillsPrerequisites()) {\n      warn('Browser does not have all the required features for web monitoring.');\n    }\n\n    const globalObjectName = win[vars.nameOfLongGlobal];\n    const globalObject = win[globalObjectName];\n\n    if (!globalObject) {\n      if (DEBUG) {\n        warn('global ' + vars.nameOfLongGlobal + ' not found. Did you use the initializer?');\n      }\n      return;\n    }\n\n    if (!globalObject.q) {\n      if (DEBUG) {\n        warn('Command queue not defined. Did you add the tracking script multiple times to your website?');\n      }\n      return;\n    }\n\n    if (typeof globalObject['l'] !== 'number') {\n      if (DEBUG) {\n        warn('Reference timestamp not set via EUM initializer. Was the initializer modified?');\n      }\n      return;\n    }\n\n    if (typeof globalObject['v'] === 'number') {\n      const version = String(Math.round(globalObject['v']));\n      if (DEBUG) {\n        info('Identified version of snippet to be:', version);\n      }\n      vars.trackingSnippetVersion = version;\n    }\n\n    // Start observing web vitals as early as possible as it registers performance observers.\n    try {\n      addWebVitals(pageLoadBeacon);\n    } catch (e) {\n      if (DEBUG) {\n        warn('Failed to capture web vitals. Will continue without web vitals', e);\n      }\n    }\n    processCommands(globalObject.q);\n\n    // prefer the backend trace ID which was explicitly set\n    vars.pageLoadBackendTraceId = vars.pageLoadBackendTraceId || getPageLoadBackendTraceId();\n    vars.initializerExecutionTimestamp = globalObject['l'];\n\n    addCommandAfterInitializationSupport();\n\n    if (!vars.reportingUrl) {\n      if (DEBUG) {\n        error('No reporting URL configured. Aborting EUM initialization.');\n      }\n      return;\n    }\n\n    hookIntoUserTimings();\n    instrumentXMLHttpRequest();\n    instrumentFetch();\n    hookIntoGlobalErrorEvent();\n    wrapTimers();\n    wrapEventHandlers();\n    hookIntoGlobalUnhandledRejectionEvent();\n    transitionTo('waitForPageLoad');\n  },\n\n  getActiveTraceId() {\n    return vars.pageLoadTraceId;\n  },\n\n  getActivePhase() {\n    return pageLoadPhase;\n  }\n};\nexport default state;\n\n\nfunction processCommands(commands) {\n  for (let i = 0, len = commands.length; i < len; i++) {\n    processCommand(commands[i]);\n  }\n}\n\n\nfunction addCommandAfterInitializationSupport() {\n  const globalObjectName = win[vars.nameOfLongGlobal];\n  win[globalObjectName] = function() {\n    return processCommand(arguments);\n  };\n}\n\n\nfunction fulfillsPrerequisites() {\n  return win.XMLHttpRequest && win.JSON;\n}\n","// @flow\n\nimport waitForPageLoad from './states/waitForPageLoad';\nimport {registerState, transitionTo} from './fsm';\nimport pageLoaded from './states/pageLoaded';\nimport init from './states/init';\n\nregisterState('init', init);\nregisterState('waitForPageLoad', waitForPageLoad);\nregisterState('pageLoaded', pageLoaded);\n\ntransitionTo('init');\n"],"names":["pageLoad","win","window","doc","document","nav","navigator","encodeURIComponent","XMLHttpRequest","originalFetch","fetch","localStorage","e","executeImageRequest","url","image","Image","src","sendBeacon","data","globalHasOwnProperty","Object","prototype","hasOwnProperty","obj","key","call","now","Date","getTime","noop","validIdCharacters","split","generateUniqueIdImpl","generateUniqueIdViaRandom","result","i","Math","round","random","crypto","getRandomValues","Uint32Array","generateUniqueIdViaCrypto","array","toString","generateUniqueId","addEventListener","target","eventType","callback","attachEvent","removeEventListener","detachEvent","matchesAny","regexp","s","len","length","test","log","DEBUG","createLogger","info","warn","error","debug","method","console","apply","arguments","globals","setTimeout","clearTimeout","setInterval","clearInterval","isRunningZoneJs","executeGlobally","globalFunctionName","args","Array","slice","bus","on","name","fn","listeners","push","emit","value","event","time","initialize","readyState","onReady","states","currentStateName","registerState","impl","transitionTo","nextStateName","onEnter","getActiveTraceId","getActivePhase","performance","webkitPerformance","msPerformance","mozPerformance","isTimingAvailable","timing","isResourceTimingAvailable","getEntriesByType","isPerformanceObserverAvailable","defaultVars","nameOfLongGlobal","trackingSnippetVersion","pageLoadTraceId","pageLoadBackendTraceId","serverTimingBackendTraceIdEntryName","referenceTimestamp","highResTimestampReference","initializerExecutionTimestamp","reportingUrl","beaconBatchingTime","maxWaitForResourceTimingsMillis","maxMaitForPageLoadMetricsMillis","apiKey","meta","ignoreUrls","ignorePings","ignoreErrorMessages","xhrTransmissionTimeout","allowedOrigins","page","undefined","wrapEventHandlers","wrappedEventHandlersOriginalFunctionStorageKey","wrapTimers","secretPropertyKey","userId","userName","userEmail","sessionId","sessionStorageKey","defaultSessionInactivityTimeoutMillis","defaultSessionTerminationTimeoutMillis","maxAllowedSessionTimeoutMillis","ignoreUserTimings","urlsToCheckForGraphQlInsights","state","onLoadEvent","onLoad","vars","pageLoadPhase","maximumNumberOfMetaDataFields","maximumLengthPerMetaDataField","languages","determineLanguages","addCommonBeaconProperties","beacon","location","href","innerWidth","innerHeight","visibilityState","addMetaDataToBeacon","join","userLanguage","serializedValue","JSON","stringify","String","substring","urlMaxLength","initiatorTypes","cachingTypes","unknown","cached","validated","fullLoad","serializeEntryToArray","entry","hasValidTimings","calculateTiming","backendTraceId","serverTimings","serverTiming","serializeEntry","replace","a","b","diff","dataUrlPrefix","ignorePingsRegex","isUrlIgnored","toLowerCase","isErrorMessageIgnored","message","INTERNAL_END_MARKER","createTrie","Trie","root","addItem","insertItem","node","keyCharacters","keyCharacterIndex","character","values","nextNode","toJs","keys","getKeys","combinedKeys","child","childKeys","addResourceTimings","minStartTime","entries","getEntriesTransferFormat","performanceEntries","trie","lowerCaseReportingUrl","lowerCaseUrl","initiatorType","indexOf","pageLoadStartTimestamp","getPageLoadStartTimestamp","navigationStart","addTimingToPageLoadBeacon","Number","redirectTime","redirectEnd","redirectStart","start","loadEventStart","fetchStart","unloadEventEnd","unloadEventStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","responseStart","requestStart","responseEnd","domContentLoadedEventStart","domLoading","loadEventEnd","addFirstPaintTimings","addFirstPaintFallbacks","paintTimings","firstPaintFound","paintTiming","startTime","firstPaint","chrome","loadTimes","isUnloading","onLastChance","persisted","disableMonitoringForXMLHttpRequest","xhr","ignored","addResourceTiming","resource","timings","getTimingValue","addCorrelationHttpHeaders","ctx","traceId","encode","beacons","str","encodePart","part","maxBatchedBeacons","pendingBeacons","pendingBeaconTransmittingTimeout","isVisibilityApiSupported","isSupported","isSendBeaconApiSupported","isEnabled","transmit","isWindowHidden","serializedBeacons","sendBeaconState","sendBeaconInternal","open","setRequestHeader","responseType","timeout","send","createExcessiveUsageIdentifier","opts","maxCalls","maxCallsPerTenMinutes","maxCallsPerTenSeconds","totalCalls","totalCallsInLastTenMinutes","totalCallsInLastTenSeconds","isExcessiveUsage","maxLengthForImgRequest","isBatchingEnabled","sendBatchedBeacon","sendFormEncodedBeacon","beaconSent","sendPageLoadBeacon","maxErrorsToReport","maxStackSize","reportedErrors","maxSeenErrorsTracked","numberOfDifferentErrorsSeen","seenErrors","scheduledTransmissionTimeoutHandle","ignoreNextOnError","ignoreNextOnErrorEvent","hookIntoGlobalErrorEvent","globalOnError","onerror","fileName","lineNumber","columnNumber","stack","onUnhandledError","reportError","shortenStackTrace","parentId","trackedError","seenCount","componentStack","transmittedCount","scheduleTransmission","seenError","sendBeaconForError","spanId","messagePrefix","stackUnavailableMessage","hookIntoGlobalUnhandledRejectionEvent","onUnhandledRejection","reason","ONE_DAY_IN_MILLIS","observeResourcePerformance","observeWithoutPerformanceObserverSupport","onEnd","endTime","observer","fallbackNoResourceFoundTimerHandle","fallbackEndNeverCalledTimerHandle","onBeforeResourceRetrieval","onAfterResourceRetrieved","cancel","disposeGlobalResources","onResource","entryTypes","cancelFallbackEndNeverCalledTimerHandle","isWaitingAcceptable","end","onVisibilityChanged","maxWaitForResourceMillis","duration","list","getEntries","resourceMatcher","disconnectResourceObserver","cancelFallbackNoResourceFoundTimer","stopVisibilityObservation","isAllowedOrigin","maximumHttpRequestUrlLength","urlAnalysisElement","createElement","normalizeUrl","hashIndex","documentOriginAnalysisElement","isSameOrigin","protocol","hostname","port","additionalStatuses","abort","openError","traceIdHeaderRegEx","instrumentXMLHttpRequest","originalOpen","originalSetRequestHeader","originalSend","async","spanAndTraceId","setBackendCorrelationHeaders","performanceObserver","onTimeout","onError","onAbort","onReadystatechange","onFinish","status","max","header","getPageLoadBackendTraceId","j","addWrappedFunction","storageTarget","wrappedFunction","valuesForEqualityCheck","storage","index","findInStorage","storageItem","matchesEqualityCheck","popWrappedFunction","fallback","splice","valuesForEqualityCheckA","valuesForEqualityCheckB","addWrappedDomEventListener","eventName","eventListener","optionsOrCapture","getDomEventListenerValuesForEqualityCheck","getDomEventListenerCaptureValue","Boolean","capture","popWrappedDomEventListener","wrapEventTarget","EventTarget","originalAddEventListener","originalRemoveEventListener","wrappedAddEventListener","wrappedEventListener","wrappedRemoveEventListener","reportCustomEvent","enrich","isNaN","hookIntoUserTimings","drainExistingPerformanceEntries","observeNewUserTimings","onUserTimings","onUserTiming","performanceEntry","entryType","onObservedPerformanceEntries","instrumentFetch","Request","input","init","request","addGraphQlProperties","headers","append","then","response","queryIdentification","mutationIdentification","body","parse","getItem","setItem","k","v","removeItem","storageSeparatorKey","trackSessions","sessionInactivityTimeoutMillis","sessionTerminationTimeoutMillis","min","storedValue","session","parseSession","isSessionValid","lastActivityTime","id","serializeSession","terminateSession","parseInt","minAllowedLastActivityTime","minAllowedStartTime","setPage","previousPage","isInitialPageDefinition","reportPageChange","processCommand","command","validateRegExpArray","arr","RegExp","wrapTimer","original","wrappedTimerSetter","wrap","wrappedTimerHandler","addWebVitals","getLCP","onMetric","getFID","getCLS","onMetricWithoutRounding","metric","toLocaleLowerCase","fulfillsPrerequisites","globalObjectName","globalObject","q","version","pageLoadBeacon","processCommands","addCommandAfterInitializationSupport","commands","waitForPageLoad","pageLoaded"],"mappings":"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"}